

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.engine.processes.workchains package &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script src="../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>aiida.engine.processes.workchains package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/apidoc/aiida.engine.processes.workchains.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-aiida.engine.processes.workchains">
<span id="aiida-engine-processes-workchains-package"></span><h1>aiida.engine.processes.workchains package<a class="headerlink" href="#module-aiida.engine.processes.workchains" title="Permalink to this headline">¶</a></h1>
<p>Module for the <cite>WorkChain</cite> process and related utilities.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.ToContext">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">ToContext</code><a class="headerlink" href="#aiida.engine.processes.workchains.ToContext" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.dict</span></code></p>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.assign_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">assign_</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/context.html#assign_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.assign_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that will construct an Awaitable for a given class instance
with the context action set to ASSIGN. When the awaitable target is completed
it will be assigned to the context for a key that is to be defined later</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> – an instance of a Process or Awaitable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the awaitable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable">Awaitable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.append_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">append_</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/context.html#append_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.append_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that will construct an Awaitable for a given class instance
with the context action set to APPEND. When the awaitable target is completed
it will be appended to a list in the context for a key that is to be defined later</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> – an instance of a Process or Awaitable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the awaitable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable">Awaitable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">BaseRestartWorkChain</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aiida.engine.processes.workchains.workchain.WorkChain" title="aiida.engine.processes.workchains.workchain.WorkChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.workchains.workchain.WorkChain</span></code></a></p>
<p>Base restart work chain.</p>
<p>This work chain serves as the starting point for more complex work chains that will be designed to run a sub process
that might need multiple restarts to come to a successful end. These restarts may be necessary because a single
process run is not sufficient to achieve a fully converged result, or certain errors maybe encountered which
are recoverable.</p>
<p>This work chain implements the most basic functionality to achieve this goal. It will launch the sub process,
restarting until it is completed successfully or the maximum number of iterations is reached. After completion of
the sub process it will be inspected, and a list of process handlers are called successively. These process handlers
are defined as class methods that are decorated with <a class="reference internal" href="aiida.engine.html#aiida.engine.process_handler" title="aiida.engine.process_handler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_handler()</span></code></a>.</p>
<p>The idea is to sub class this work chain and leverage the generic error handling that is implemented in the few
outline methods. The minimally required outline would look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="o">.</span><span class="n">setup</span>
<span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">should_run_process</span><span class="p">)(</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">run_process</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">inspect_process</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each of these methods can of course be overriden but they should be general enough to fit most process cycles. The
<cite>run_process</cite> method will take the inputs for the process from the context under the key <cite>inputs</cite>. The user should,
therefore, make sure that before the <cite>run_process</cite> method is called, that the to be used inputs are stored under
<cite>self.ctx.inputs</cite>. One can update the inputs based on the results from a prior process by calling an outline method
just before the <cite>run_process</cite> step, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="o">.</span><span class="n">setup</span>
<span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">should_run_process</span><span class="p">)(</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">prepare_inputs</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">run_process</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">inspect_process</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Where in the <cite>prepare_calculation</cite> method, the inputs dictionary at <cite>self.ctx.inputs</cite> is updated before the next
process will be run with those inputs.</p>
<p>The <cite>_process_class</cite> attribute should be set to the <cite>Process</cite> class that should be run in the loop.
Finally, to define handlers that will be called during the <cite>inspect_process</cite> simply define a class method with the
signature <cite>(self, node)</cite> and decorate it with the <cite>process_handler</cite> decorator, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@process_handler</span>
<span class="k">def</span> <span class="nf">handle_problem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">some_problem</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">improved_inputs</span>
        <span class="k">return</span> <span class="n">ProcessHandlerReport</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>process_handler</cite> and <cite>ProcessHandlerReport</cite> support various arguments to control the flow of the logic of the
<cite>inspect_process</cite>. Refer to their respective documentation for details.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._Process__called">
<code class="sig-name descname">_Process__called</code><em class="property"> = True</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._Process__called" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.__abstractmethods__">
<code class="sig-name descname">__abstractmethods__</code><em class="property"> = frozenset({})</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.__abstractmethods__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.restart'</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._abc_impl">
<code class="sig-name descname">_abc_impl</code><em class="property"> = &lt;_abc_data object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._considered_handlers_extra">
<code class="sig-name descname">_considered_handlers_extra</code><em class="property"> = 'considered_handlers'</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._considered_handlers_extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._process_class">
<code class="sig-name descname">_process_class</code><em class="property"> = None</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._process_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._spec">
<code class="sig-name descname">_spec</code><em class="property"> = &lt;aiida.engine.processes.workchains.workchain.WorkChainSpec object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain._wrap_bare_dict_inputs">
<code class="sig-name descname">_wrap_bare_dict_inputs</code><span class="sig-paren">(</span><em class="sig-param">port_namespace</em>, <em class="sig-param">inputs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain._wrap_bare_dict_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain._wrap_bare_dict_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap bare dictionaries in <cite>inputs</cite> in a <cite>Dict</cite> node if dictated by the corresponding inputs portnamespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port_namespace</strong> – a <cite>PortNamespace</cite></p></li>
<li><p><strong>inputs</strong> – a dictionary of inputs intended for submission of the process</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an attribute dictionary with all bare dictionaries wrapped in <cite>Dict</cite> if dictated by the port namespace</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.define">
<em class="property">classmethod </em><code class="sig-name descname">define</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.define"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.define" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the process specification.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.get_process_handlers">
<em class="property">classmethod </em><code class="sig-name descname">get_process_handlers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.get_process_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.get_process_handlers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.inspect_process">
<code class="sig-name descname">inspect_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.inspect_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.inspect_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse the results of the previous process and call the handlers when necessary.</p>
<p>If the process is excepted or killed, the work chain will abort. Otherwise any attached handlers will be called
in order of their specified priority. If the process was failed and no handler returns a report indicating that
the error was handled, it is considered an unhandled process failure and the process is relaunched. If this
happens twice in a row, the work chain is aborted. In the case that at least one handler returned a report the
following matrix determines the logic that is followed:</p>
<blockquote>
<div><p>Process  Handler    Handler     Action
result   report?    exit code
—————————————–
Success      yes        == 0     Restart
Success      yes        != 0     Abort
Failed       yes        == 0     Restart
Failed       yes        != 0     Abort</p>
</div></blockquote>
<p>If no handler returned a report and the process finished successfully, the work chain’s work is considered done
and it will move on to the next step that directly follows the <cite>while</cite> conditional, if there is one defined in
the outline.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.is_process_handler">
<em class="property">classmethod </em><code class="sig-name descname">is_process_handler</code><span class="sig-paren">(</span><em class="sig-param">process_handler_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.is_process_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.is_process_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the given method name corresponds to a process handler of this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>process_handler_name</strong> – string name of the instance method</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boolean, True if corresponds to process handler, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.on_terminated">
<code class="sig-name descname">on_terminated</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.on_terminated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.on_terminated" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the working directories of all child calculation jobs if <cite>clean_workdir=True</cite> in the inputs.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.results">
<code class="sig-name descname">results</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.results" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach the outputs specified in the output specification from the last completed process.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.run_process">
<code class="sig-name descname">run_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.run_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.run_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the next process, taking the input dictionary from the context at <cite>self.ctx.inputs</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize context variables that are used during the logical flow of the <cite>BaseRestartWorkChain</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.BaseRestartWorkChain.should_run_process">
<code class="sig-name descname">should_run_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.should_run_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.BaseRestartWorkChain.should_run_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether a new process should be run.</p>
<p>This is the case as long as the last process has not finished successfully and the maximum number of restarts
has not yet been exceeded.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">ProcessHandlerReport</code><span class="sig-paren">(</span><em class="sig-param">do_break</em>, <em class="sig-param">exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.__getnewargs__">
<code class="sig-name descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.utils'</em><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.__new__">
<em class="property">static </em><code class="sig-name descname">__new__</code><span class="sig-paren">(</span><em class="sig-param">_cls</em>, <em class="sig-param">do_break=False</em>, <em class="sig-param">exit_code=ExitCode(status=0</em>, <em class="sig-param">message=None</em>, <em class="sig-param">invalidates_cache=False)</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.__new__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new instance of ProcessHandlerReport(do_break, exit_code)</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.__slots__">
<code class="sig-name descname">__slots__</code><em class="property"> = ()</em><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.__slots__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport._asdict">
<code class="sig-name descname">_asdict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport._asdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new OrderedDict which maps field names to their values.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport._fields">
<code class="sig-name descname">_fields</code><em class="property"> = ('do_break', 'exit_code')</em><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport._fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport._fields_defaults">
<code class="sig-name descname">_fields_defaults</code><em class="property"> = {}</em><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport._fields_defaults" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport._make">
<em class="property">classmethod </em><code class="sig-name descname">_make</code><span class="sig-paren">(</span><em class="sig-param">iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport._make" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a new ProcessHandlerReport object from a sequence or iterable</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport._replace">
<code class="sig-name descname">_replace</code><span class="sig-paren">(</span><em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport._replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new ProcessHandlerReport object replacing specified fields with new values</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.do_break">
<em class="property">property </em><code class="sig-name descname">do_break</code><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.do_break" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.ProcessHandlerReport.exit_code">
<em class="property">property </em><code class="sig-name descname">exit_code</code><a class="headerlink" href="#aiida.engine.processes.workchains.ProcessHandlerReport.exit_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.process_handler">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">process_handler</code><span class="sig-paren">(</span><em class="sig-param">wrapped=None</em>, <em class="sig-param">*</em>, <em class="sig-param">priority=0</em>, <em class="sig-param">exit_codes=None</em>, <em class="sig-param">enabled=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/utils.html#process_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.process_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to register a <a class="reference internal" href="aiida.engine.html#aiida.engine.BaseRestartWorkChain" title="aiida.engine.BaseRestartWorkChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRestartWorkChain</span></code></a> instance method as a process handler.</p>
<p>The decorator will validate the <cite>priority</cite> and <cite>exit_codes</cite> optional keyword arguments and then add itself as an
attribute to the <cite>wrapped</cite> instance method. This is used in the <cite>inspect_process</cite> to return all instance methods of
the class that have been decorated by this function and therefore are considered to be process handlers.</p>
<p>Requirements on the function signature of process handling functions. The function to which the decorator is applied
needs to take two arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>self</cite>: This is the instance of the work chain itself</p></li>
<li><p><cite>node</cite>: This is the process node that finished and is to be investigated</p></li>
</ul>
</div></blockquote>
<p>The function body typically consists of a conditional that will check for a particular problem that might have
occurred for the sub process. If a particular problem is handled, the process handler should return an instance of
the <a class="reference internal" href="aiida.engine.html#aiida.engine.ProcessHandlerReport" title="aiida.engine.ProcessHandlerReport"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.ProcessHandlerReport</span></code></a> tuple. If no other process handlers should be considered, the set
<cite>do_break</cite> attribute should be set to <cite>True</cite>. If the work chain is to be aborted entirely, the <cite>exit_code</cite> of the
report can be set to an <cite>ExitCode</cite> instance with a non-zero status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – the work chain class to register the process handler with</p></li>
<li><p><strong>priority</strong> – optional integer that defines the order in which registered handlers will be called during the
handling of a finished process. Higher priorities will be handled first. Default value is <cite>0</cite>. Multiple handlers
with the same priority is allowed, but the order of those is not well defined.</p></li>
<li><p><strong>exit_codes</strong> – single or list of <cite>ExitCode</cite> instances. If defined, the handler will return <cite>None</cite> if the exit
code set on the <cite>node</cite> does not appear in the <cite>exit_codes</cite>. This is useful to have a handler called only when
the process failed with a specific exit code.</p></li>
<li><p><strong>enabled</strong> – boolean, by default True, which will cause the handler to be called during <cite>inspect_process</cite>. When
set to <cite>False</cite>, the handler will be skipped. This static value can be overridden on a per work chain instance
basis through the input <cite>handler_overrides</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="aiida.engine.processes.workchains.WorkChain">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">WorkChain</code><span class="sig-paren">(</span><em class="sig-param">inputs=None</em>, <em class="sig-param">logger=None</em>, <em class="sig-param">runner=None</em>, <em class="sig-param">enable_persistence=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="aiida.engine.processes.html#aiida.engine.processes.process.Process" title="aiida.engine.processes.process.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.process.Process</span></code></a></p>
<p>The <cite>WorkChain</cite> class is the principle component to implement workflows in AiiDA.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._CONTEXT">
<code class="sig-name descname">_CONTEXT</code><em class="property"> = 'CONTEXT'</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._CONTEXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._Process__called">
<code class="sig-name descname">_Process__called</code><em class="property"> = True</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._Process__called" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._STEPPER_STATE">
<code class="sig-name descname">_STEPPER_STATE</code><em class="property"> = 'stepper_state'</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._STEPPER_STATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain.__abstractmethods__">
<code class="sig-name descname">__abstractmethods__</code><em class="property"> = frozenset({})</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.__abstractmethods__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">inputs=None</em>, <em class="sig-param">logger=None</em>, <em class="sig-param">runner=None</em>, <em class="sig-param">enable_persistence=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a WorkChain instance.</p>
<p>Construct the instance only if it is a sub class of <cite>WorkChain</cite>, otherwise raise <cite>InvalidOperation</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – work chain inputs</p></li>
<li><p><strong>logger</strong> (<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a>) – aiida logger</p></li>
<li><p><strong>runner</strong> – work chain runner</p></li>
<li><p><strong>enable_persistence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to persist this work chain</p></li>
</ul>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p><a class="reference internal" href="aiida.engine.html#aiida.engine.runners.Runner" title="aiida.engine.runners.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.runners.Runner</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.workchain'</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._abc_impl">
<code class="sig-name descname">_abc_impl</code><em class="property"> = &lt;_abc_data object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._auto_persist">
<code class="sig-name descname">_auto_persist</code><em class="property"> = {'_CREATION_TIME', '_awaitables', '_enable_persistence', '_future', '_parent_pid', '_paused', '_pid', '_pre_paused_status', '_status'}</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._auto_persist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain._do_step">
<code class="sig-name descname">_do_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._do_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._do_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the next step in the outline and return the result.</p>
<p>If the stepper returns a non-finished status and the return value is of type ToContext, the contents of the
ToContext container will be turned into awaitables if necessary. If any awaitables were created, the process
will enter in the Wait state, otherwise it will go to Continue. When the stepper returns that it is done, the
stepper result will be converted to None and returned, unless it is an integer or instance of ExitCode.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._node_class">
<code class="sig-name descname">_node_class</code><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._node_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="aiida.orm.nodes.process.workflow.html#aiida.orm.nodes.process.workflow.workchain.WorkChainNode" title="aiida.orm.nodes.process.workflow.workchain.WorkChainNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.orm.nodes.process.workflow.workchain.WorkChainNode</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._spec">
<code class="sig-name descname">_spec</code><em class="property"> = &lt;aiida.engine.processes.workchains.workchain.WorkChainSpec object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.WorkChain._spec_class">
<code class="sig-name descname">_spec_class</code><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._spec_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">WorkChainSpec</span></code></p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain._store_nodes">
<code class="sig-name descname">_store_nodes</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._store_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._store_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Recurse through a data structure and store any unstored nodes that are found along the way</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – a data structure potentially containing unstored nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain._update_process_status">
<code class="sig-name descname">_update_process_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._update_process_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain._update_process_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the process status with a message accounting the current sub processes that we are waiting for.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.action_awaitables">
<code class="sig-name descname">action_awaitables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.action_awaitables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.action_awaitables" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle the awaitables that are currently registered with the work chain</p>
<p>Depending on the class type of the awaitable’s target a different callback
function will be bound with the awaitable and the runner will be asked to
call it when the target is completed</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.ctx">
<em class="property">property </em><code class="sig-name descname">ctx</code><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get context.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="aiida.common.html#aiida.common.extendeddicts.AttributeDict" title="aiida.common.extendeddicts.AttributeDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.common.extendeddicts.AttributeDict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.insert_awaitable">
<code class="sig-name descname">insert_awaitable</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.insert_awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.insert_awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an awaitable that should be terminated before before continuing to the next step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>awaitable</strong> (<a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.workchains.awaitable.Awaitable</span></code></a>) – the thing to await</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.load_instance_state">
<code class="sig-name descname">load_instance_state</code><span class="sig-paren">(</span><em class="sig-param">saved_state</em>, <em class="sig-param">load_context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.load_instance_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.load_instance_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Load instance state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>saved_state</strong> – saved instance state</p></li>
<li><p><strong>load_context</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">plumpy.persistence.LoadSaveContext</span></code>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.on_exiting">
<code class="sig-name descname">on_exiting</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_exiting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.on_exiting" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that any unstored nodes in the context are stored, before the state is exited</p>
<p>After the state is exited the next state will be entered and if persistence is enabled, a checkpoint will
be saved. If the context contains unstored nodes, the serialization necessary for checkpointing will fail.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.on_process_finished">
<code class="sig-name descname">on_process_finished</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em>, <em class="sig-param">pk</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_process_finished"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.on_process_finished" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function called by the runner when the process instance identified by pk is completed.</p>
<p>The awaitable will be effectuated on the context of the work chain and removed from the internal list. If all
awaitables have been dealt with, the work chain process is resumed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>awaitable</strong> – an Awaitable instance</p></li>
<li><p><strong>pk</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the pk of the awaitable’s target</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.on_run">
<code class="sig-name descname">on_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.on_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.on_wait">
<code class="sig-name descname">on_wait</code><span class="sig-paren">(</span><em class="sig-param">awaitables</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.on_wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.remove_awaitable">
<code class="sig-name descname">remove_awaitable</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.remove_awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.remove_awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an awaitable.</p>
<p>Precondition: must be an awaitable that was previously inserted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>awaitable</strong> – the awaitable to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.save_instance_state">
<code class="sig-name descname">save_instance_state</code><span class="sig-paren">(</span><em class="sig-param">out_state</em>, <em class="sig-param">save_context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.save_instance_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.save_instance_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance stace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_state</strong> – state to save in</p></li>
<li><p><strong>save_context</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">plumpy.persistence.LoadSaveContext</span></code>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.WorkChain.to_context">
<code class="sig-name descname">to_context</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.to_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.WorkChain.to_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dictionary of awaitables to the context.</p>
<p>This is a convenience method that provides syntactic sugar, for a user to add multiple intersteps that will
assign a certain value to the corresponding key in the context of the work chain.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.if_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">if_</code><span class="sig-paren">(</span><em class="sig-param">condition</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plumpy/workchains.html#if_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.if_" title="Permalink to this definition">¶</a></dt>
<dd><p>A conditional that can be used in a workchain outline.</p>
<p>Use as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">if_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">conditional</span><span class="p">)(</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step1</span><span class="p">,</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step2</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each step can, of course, also be any valid workchain step e.g. conditional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condition</strong> – The workchain method that will return True or False</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.while_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.</code><code class="sig-name descname">while_</code><span class="sig-paren">(</span><em class="sig-param">condition</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plumpy/workchains.html#while_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.while_" title="Permalink to this definition">¶</a></dt>
<dd><p>A while loop that can be used in a workchain outline.</p>
<p>Use as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">conditional</span><span class="p">)(</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step1</span><span class="p">,</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step2</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each step can, of course, also be any valid workchain step e.g. conditional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condition</strong> – The workchain method that will return True or False</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="module-aiida.engine.processes.workchains.awaitable">
<span id="submodules"></span><h2>Submodules<a class="headerlink" href="#module-aiida.engine.processes.workchains.awaitable" title="Permalink to this headline">¶</a></h2>
<p>Enums and function for the awaitables of Processes.</p>
<dl class="class">
<dt id="aiida.engine.processes.workchains.awaitable.Awaitable">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.awaitable.</code><code class="sig-name descname">Awaitable</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/awaitable.html#Awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">plumpy.utils.AttributesDict</span></code></p>
<p>An attribute dictionary that represents an action that a Process could be waiting for to finish.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.Awaitable.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.awaitable'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.Awaitable.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableTarget">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.awaitable.</code><code class="sig-name descname">AwaitableTarget</code><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/awaitable.html#AwaitableTarget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableTarget" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum that describes the class of the target a given awaitable.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableTarget.PROCESS">
<code class="sig-name descname">PROCESS</code><em class="property"> = 'process'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableTarget.PROCESS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableTarget.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.awaitable'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableTarget.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableAction">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.awaitable.</code><code class="sig-name descname">AwaitableAction</code><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/awaitable.html#AwaitableAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum that describes the action to be taken for a given awaitable.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableAction.APPEND">
<code class="sig-name descname">APPEND</code><em class="property"> = 'append'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableAction.APPEND" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableAction.ASSIGN">
<code class="sig-name descname">ASSIGN</code><em class="property"> = 'assign'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableAction.ASSIGN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.awaitable.AwaitableAction.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.awaitable'</em><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.AwaitableAction.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.awaitable.construct_awaitable">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.awaitable.</code><code class="sig-name descname">construct_awaitable</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/awaitable.html#construct_awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.awaitable.construct_awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance of the Awaitable class that will contain the information
related to the action to be taken with respect to the context once the awaitable
object is completed.</p>
<p>The awaitable is a simple dictionary with the following keys</p>
<blockquote>
<div><ul class="simple">
<li><p>pk: the pk of the node that is being waited on</p></li>
<li><p>action: the context action to be performed upon completion</p></li>
<li><p>outputs: a boolean that toggles whether the node itself</p></li>
</ul>
</div></blockquote>
<p>Currently the only awaitable classes are ProcessNode and Workflow
The only awaitable actions are the Assign and Append operators</p>
</dd></dl>

<span class="target" id="module-aiida.engine.processes.workchains.context"></span><p>Convenience functions to add awaitables to the Context of a WorkChain.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.context.ToContext">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.context.</code><code class="sig-name descname">ToContext</code><a class="headerlink" href="#aiida.engine.processes.workchains.context.ToContext" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.dict</span></code></p>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.context.assign_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.context.</code><code class="sig-name descname">assign_</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/context.html#assign_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.context.assign_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that will construct an Awaitable for a given class instance
with the context action set to ASSIGN. When the awaitable target is completed
it will be assigned to the context for a key that is to be defined later</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> – an instance of a Process or Awaitable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the awaitable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable">Awaitable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.context.append_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.context.</code><code class="sig-name descname">append_</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/context.html#append_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.context.append_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that will construct an Awaitable for a given class instance
with the context action set to APPEND. When the awaitable target is completed
it will be appended to a list in the context for a key that is to be defined later</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> – an instance of a Process or Awaitable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the awaitable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable">Awaitable</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-aiida.engine.processes.workchains.restart"></span><p>Base implementation of <cite>WorkChain</cite> class that implements a simple automated restart mechanism for sub processes.</p>
<dl class="class">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.restart.</code><code class="sig-name descname">BaseRestartWorkChain</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aiida.engine.processes.workchains.workchain.WorkChain" title="aiida.engine.processes.workchains.workchain.WorkChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.workchains.workchain.WorkChain</span></code></a></p>
<p>Base restart work chain.</p>
<p>This work chain serves as the starting point for more complex work chains that will be designed to run a sub process
that might need multiple restarts to come to a successful end. These restarts may be necessary because a single
process run is not sufficient to achieve a fully converged result, or certain errors maybe encountered which
are recoverable.</p>
<p>This work chain implements the most basic functionality to achieve this goal. It will launch the sub process,
restarting until it is completed successfully or the maximum number of iterations is reached. After completion of
the sub process it will be inspected, and a list of process handlers are called successively. These process handlers
are defined as class methods that are decorated with <a class="reference internal" href="aiida.engine.html#aiida.engine.process_handler" title="aiida.engine.process_handler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_handler()</span></code></a>.</p>
<p>The idea is to sub class this work chain and leverage the generic error handling that is implemented in the few
outline methods. The minimally required outline would look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="o">.</span><span class="n">setup</span>
<span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">should_run_process</span><span class="p">)(</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">run_process</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">inspect_process</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each of these methods can of course be overriden but they should be general enough to fit most process cycles. The
<cite>run_process</cite> method will take the inputs for the process from the context under the key <cite>inputs</cite>. The user should,
therefore, make sure that before the <cite>run_process</cite> method is called, that the to be used inputs are stored under
<cite>self.ctx.inputs</cite>. One can update the inputs based on the results from a prior process by calling an outline method
just before the <cite>run_process</cite> step, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="o">.</span><span class="n">setup</span>
<span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">should_run_process</span><span class="p">)(</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">prepare_inputs</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">run_process</span><span class="p">,</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">inspect_process</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Where in the <cite>prepare_calculation</cite> method, the inputs dictionary at <cite>self.ctx.inputs</cite> is updated before the next
process will be run with those inputs.</p>
<p>The <cite>_process_class</cite> attribute should be set to the <cite>Process</cite> class that should be run in the loop.
Finally, to define handlers that will be called during the <cite>inspect_process</cite> simply define a class method with the
signature <cite>(self, node)</cite> and decorate it with the <cite>process_handler</cite> decorator, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@process_handler</span>
<span class="k">def</span> <span class="nf">handle_problem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">some_problem</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">improved_inputs</span>
        <span class="k">return</span> <span class="n">ProcessHandlerReport</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>process_handler</cite> and <cite>ProcessHandlerReport</cite> support various arguments to control the flow of the logic of the
<cite>inspect_process</cite>. Refer to their respective documentation for details.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._Process__called">
<code class="sig-name descname">_Process__called</code><em class="property"> = True</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._Process__called" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__abstractmethods__">
<code class="sig-name descname">__abstractmethods__</code><em class="property"> = frozenset({})</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__abstractmethods__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.restart'</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._abc_impl">
<code class="sig-name descname">_abc_impl</code><em class="property"> = &lt;_abc_data object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._considered_handlers_extra">
<code class="sig-name descname">_considered_handlers_extra</code><em class="property"> = 'considered_handlers'</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._considered_handlers_extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._process_class">
<code class="sig-name descname">_process_class</code><em class="property"> = None</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._process_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._spec">
<code class="sig-name descname">_spec</code><em class="property"> = &lt;aiida.engine.processes.workchains.workchain.WorkChainSpec object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain._wrap_bare_dict_inputs">
<code class="sig-name descname">_wrap_bare_dict_inputs</code><span class="sig-paren">(</span><em class="sig-param">port_namespace</em>, <em class="sig-param">inputs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain._wrap_bare_dict_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain._wrap_bare_dict_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap bare dictionaries in <cite>inputs</cite> in a <cite>Dict</cite> node if dictated by the corresponding inputs portnamespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port_namespace</strong> – a <cite>PortNamespace</cite></p></li>
<li><p><strong>inputs</strong> – a dictionary of inputs intended for submission of the process</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an attribute dictionary with all bare dictionaries wrapped in <cite>Dict</cite> if dictated by the port namespace</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.define">
<em class="property">classmethod </em><code class="sig-name descname">define</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.define"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.define" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the process specification.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.get_process_handlers">
<em class="property">classmethod </em><code class="sig-name descname">get_process_handlers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.get_process_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.get_process_handlers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.inspect_process">
<code class="sig-name descname">inspect_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.inspect_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.inspect_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse the results of the previous process and call the handlers when necessary.</p>
<p>If the process is excepted or killed, the work chain will abort. Otherwise any attached handlers will be called
in order of their specified priority. If the process was failed and no handler returns a report indicating that
the error was handled, it is considered an unhandled process failure and the process is relaunched. If this
happens twice in a row, the work chain is aborted. In the case that at least one handler returned a report the
following matrix determines the logic that is followed:</p>
<blockquote>
<div><p>Process  Handler    Handler     Action
result   report?    exit code
—————————————–
Success      yes        == 0     Restart
Success      yes        != 0     Abort
Failed       yes        == 0     Restart
Failed       yes        != 0     Abort</p>
</div></blockquote>
<p>If no handler returned a report and the process finished successfully, the work chain’s work is considered done
and it will move on to the next step that directly follows the <cite>while</cite> conditional, if there is one defined in
the outline.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.is_process_handler">
<em class="property">classmethod </em><code class="sig-name descname">is_process_handler</code><span class="sig-paren">(</span><em class="sig-param">process_handler_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.is_process_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.is_process_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the given method name corresponds to a process handler of this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>process_handler_name</strong> – string name of the instance method</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boolean, True if corresponds to process handler, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.on_terminated">
<code class="sig-name descname">on_terminated</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.on_terminated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.on_terminated" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the working directories of all child calculation jobs if <cite>clean_workdir=True</cite> in the inputs.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.results">
<code class="sig-name descname">results</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.results" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach the outputs specified in the output specification from the last completed process.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.run_process">
<code class="sig-name descname">run_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.run_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.run_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the next process, taking the input dictionary from the context at <cite>self.ctx.inputs</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize context variables that are used during the logical flow of the <cite>BaseRestartWorkChain</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.restart.BaseRestartWorkChain.should_run_process">
<code class="sig-name descname">should_run_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/restart.html#BaseRestartWorkChain.should_run_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.restart.BaseRestartWorkChain.should_run_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether a new process should be run.</p>
<p>This is the case as long as the last process has not finished successfully and the maximum number of restarts
has not yet been exceeded.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-aiida.engine.processes.workchains.utils"></span><p>Utilities for <cite>WorkChain</cite> implementations.</p>
<dl class="class">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.utils.</code><code class="sig-name descname">ProcessHandlerReport</code><span class="sig-paren">(</span><em class="sig-param">do_break</em>, <em class="sig-param">exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.__getnewargs__">
<code class="sig-name descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.utils'</em><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.__new__">
<em class="property">static </em><code class="sig-name descname">__new__</code><span class="sig-paren">(</span><em class="sig-param">_cls</em>, <em class="sig-param">do_break=False</em>, <em class="sig-param">exit_code=ExitCode(status=0</em>, <em class="sig-param">message=None</em>, <em class="sig-param">invalidates_cache=False)</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.__new__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new instance of ProcessHandlerReport(do_break, exit_code)</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.__slots__">
<code class="sig-name descname">__slots__</code><em class="property"> = ()</em><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.__slots__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport._asdict">
<code class="sig-name descname">_asdict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport._asdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new OrderedDict which maps field names to their values.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport._fields">
<code class="sig-name descname">_fields</code><em class="property"> = ('do_break', 'exit_code')</em><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport._fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport._fields_defaults">
<code class="sig-name descname">_fields_defaults</code><em class="property"> = {}</em><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport._fields_defaults" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport._make">
<em class="property">classmethod </em><code class="sig-name descname">_make</code><span class="sig-paren">(</span><em class="sig-param">iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport._make" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a new ProcessHandlerReport object from a sequence or iterable</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport._replace">
<code class="sig-name descname">_replace</code><span class="sig-paren">(</span><em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport._replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new ProcessHandlerReport object replacing specified fields with new values</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.do_break">
<em class="property">property </em><code class="sig-name descname">do_break</code><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.do_break" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.utils.ProcessHandlerReport.exit_code">
<em class="property">property </em><code class="sig-name descname">exit_code</code><a class="headerlink" href="#aiida.engine.processes.workchains.utils.ProcessHandlerReport.exit_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.utils.process_handler">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.utils.</code><code class="sig-name descname">process_handler</code><span class="sig-paren">(</span><em class="sig-param">wrapped=None</em>, <em class="sig-param">*</em>, <em class="sig-param">priority=0</em>, <em class="sig-param">exit_codes=None</em>, <em class="sig-param">enabled=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/utils.html#process_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.utils.process_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to register a <a class="reference internal" href="aiida.engine.html#aiida.engine.BaseRestartWorkChain" title="aiida.engine.BaseRestartWorkChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRestartWorkChain</span></code></a> instance method as a process handler.</p>
<p>The decorator will validate the <cite>priority</cite> and <cite>exit_codes</cite> optional keyword arguments and then add itself as an
attribute to the <cite>wrapped</cite> instance method. This is used in the <cite>inspect_process</cite> to return all instance methods of
the class that have been decorated by this function and therefore are considered to be process handlers.</p>
<p>Requirements on the function signature of process handling functions. The function to which the decorator is applied
needs to take two arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>self</cite>: This is the instance of the work chain itself</p></li>
<li><p><cite>node</cite>: This is the process node that finished and is to be investigated</p></li>
</ul>
</div></blockquote>
<p>The function body typically consists of a conditional that will check for a particular problem that might have
occurred for the sub process. If a particular problem is handled, the process handler should return an instance of
the <a class="reference internal" href="aiida.engine.html#aiida.engine.ProcessHandlerReport" title="aiida.engine.ProcessHandlerReport"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.ProcessHandlerReport</span></code></a> tuple. If no other process handlers should be considered, the set
<cite>do_break</cite> attribute should be set to <cite>True</cite>. If the work chain is to be aborted entirely, the <cite>exit_code</cite> of the
report can be set to an <cite>ExitCode</cite> instance with a non-zero status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – the work chain class to register the process handler with</p></li>
<li><p><strong>priority</strong> – optional integer that defines the order in which registered handlers will be called during the
handling of a finished process. Higher priorities will be handled first. Default value is <cite>0</cite>. Multiple handlers
with the same priority is allowed, but the order of those is not well defined.</p></li>
<li><p><strong>exit_codes</strong> – single or list of <cite>ExitCode</cite> instances. If defined, the handler will return <cite>None</cite> if the exit
code set on the <cite>node</cite> does not appear in the <cite>exit_codes</cite>. This is useful to have a handler called only when
the process failed with a specific exit code.</p></li>
<li><p><strong>enabled</strong> – boolean, by default True, which will cause the handler to be called during <cite>inspect_process</cite>. When
set to <cite>False</cite>, the handler will be skipped. This static value can be overridden on a per work chain instance
basis through the input <cite>handler_overrides</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-aiida.engine.processes.workchains.workchain"></span><p>Components for the WorkChain concept of the workflow engine.</p>
<dl class="class">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain">
<em class="property">class </em><code class="sig-prename descclassname">aiida.engine.processes.workchains.workchain.</code><code class="sig-name descname">WorkChain</code><span class="sig-paren">(</span><em class="sig-param">inputs=None</em>, <em class="sig-param">logger=None</em>, <em class="sig-param">runner=None</em>, <em class="sig-param">enable_persistence=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="aiida.engine.processes.html#aiida.engine.processes.process.Process" title="aiida.engine.processes.process.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.process.Process</span></code></a></p>
<p>The <cite>WorkChain</cite> class is the principle component to implement workflows in AiiDA.</p>
<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._CONTEXT">
<code class="sig-name descname">_CONTEXT</code><em class="property"> = 'CONTEXT'</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._CONTEXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._Process__called">
<code class="sig-name descname">_Process__called</code><em class="property"> = True</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._Process__called" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._STEPPER_STATE">
<code class="sig-name descname">_STEPPER_STATE</code><em class="property"> = 'stepper_state'</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._STEPPER_STATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.__abstractmethods__">
<code class="sig-name descname">__abstractmethods__</code><em class="property"> = frozenset({})</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.__abstractmethods__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">inputs=None</em>, <em class="sig-param">logger=None</em>, <em class="sig-param">runner=None</em>, <em class="sig-param">enable_persistence=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a WorkChain instance.</p>
<p>Construct the instance only if it is a sub class of <cite>WorkChain</cite>, otherwise raise <cite>InvalidOperation</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – work chain inputs</p></li>
<li><p><strong>logger</strong> (<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a>) – aiida logger</p></li>
<li><p><strong>runner</strong> – work chain runner</p></li>
<li><p><strong>enable_persistence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to persist this work chain</p></li>
</ul>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p><a class="reference internal" href="aiida.engine.html#aiida.engine.runners.Runner" title="aiida.engine.runners.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.runners.Runner</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'aiida.engine.processes.workchains.workchain'</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._abc_impl">
<code class="sig-name descname">_abc_impl</code><em class="property"> = &lt;_abc_data object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._auto_persist">
<code class="sig-name descname">_auto_persist</code><em class="property"> = {'_CREATION_TIME', '_awaitables', '_enable_persistence', '_future', '_parent_pid', '_paused', '_pid', '_pre_paused_status', '_status'}</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._auto_persist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._do_step">
<code class="sig-name descname">_do_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._do_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._do_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the next step in the outline and return the result.</p>
<p>If the stepper returns a non-finished status and the return value is of type ToContext, the contents of the
ToContext container will be turned into awaitables if necessary. If any awaitables were created, the process
will enter in the Wait state, otherwise it will go to Continue. When the stepper returns that it is done, the
stepper result will be converted to None and returned, unless it is an integer or instance of ExitCode.</p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._node_class">
<code class="sig-name descname">_node_class</code><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._node_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="aiida.orm.nodes.process.workflow.html#aiida.orm.nodes.process.workflow.workchain.WorkChainNode" title="aiida.orm.nodes.process.workflow.workchain.WorkChainNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.orm.nodes.process.workflow.workchain.WorkChainNode</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._spec">
<code class="sig-name descname">_spec</code><em class="property"> = &lt;aiida.engine.processes.workchains.workchain.WorkChainSpec object&gt;</em><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._spec_class">
<code class="sig-name descname">_spec_class</code><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._spec_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">WorkChainSpec</span></code></p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._store_nodes">
<code class="sig-name descname">_store_nodes</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._store_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._store_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Recurse through a data structure and store any unstored nodes that are found along the way</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – a data structure potentially containing unstored nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain._update_process_status">
<code class="sig-name descname">_update_process_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain._update_process_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain._update_process_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the process status with a message accounting the current sub processes that we are waiting for.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.action_awaitables">
<code class="sig-name descname">action_awaitables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.action_awaitables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.action_awaitables" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle the awaitables that are currently registered with the work chain</p>
<p>Depending on the class type of the awaitable’s target a different callback
function will be bound with the awaitable and the runner will be asked to
call it when the target is completed</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.ctx">
<em class="property">property </em><code class="sig-name descname">ctx</code><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get context.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="aiida.common.html#aiida.common.extendeddicts.AttributeDict" title="aiida.common.extendeddicts.AttributeDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.common.extendeddicts.AttributeDict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.insert_awaitable">
<code class="sig-name descname">insert_awaitable</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.insert_awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.insert_awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an awaitable that should be terminated before before continuing to the next step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>awaitable</strong> (<a class="reference internal" href="#aiida.engine.processes.workchains.awaitable.Awaitable" title="aiida.engine.processes.workchains.awaitable.Awaitable"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.engine.processes.workchains.awaitable.Awaitable</span></code></a>) – the thing to await</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.load_instance_state">
<code class="sig-name descname">load_instance_state</code><span class="sig-paren">(</span><em class="sig-param">saved_state</em>, <em class="sig-param">load_context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.load_instance_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.load_instance_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Load instance state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>saved_state</strong> – saved instance state</p></li>
<li><p><strong>load_context</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">plumpy.persistence.LoadSaveContext</span></code>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.on_exiting">
<code class="sig-name descname">on_exiting</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_exiting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.on_exiting" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that any unstored nodes in the context are stored, before the state is exited</p>
<p>After the state is exited the next state will be entered and if persistence is enabled, a checkpoint will
be saved. If the context contains unstored nodes, the serialization necessary for checkpointing will fail.</p>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.on_process_finished">
<code class="sig-name descname">on_process_finished</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em>, <em class="sig-param">pk</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_process_finished"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.on_process_finished" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function called by the runner when the process instance identified by pk is completed.</p>
<p>The awaitable will be effectuated on the context of the work chain and removed from the internal list. If all
awaitables have been dealt with, the work chain process is resumed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>awaitable</strong> – an Awaitable instance</p></li>
<li><p><strong>pk</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the pk of the awaitable’s target</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.on_run">
<code class="sig-name descname">on_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.on_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.on_wait">
<code class="sig-name descname">on_wait</code><span class="sig-paren">(</span><em class="sig-param">awaitables</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.on_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.on_wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.remove_awaitable">
<code class="sig-name descname">remove_awaitable</code><span class="sig-paren">(</span><em class="sig-param">awaitable</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.remove_awaitable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.remove_awaitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an awaitable.</p>
<p>Precondition: must be an awaitable that was previously inserted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>awaitable</strong> – the awaitable to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.save_instance_state">
<code class="sig-name descname">save_instance_state</code><span class="sig-paren">(</span><em class="sig-param">out_state</em>, <em class="sig-param">save_context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.save_instance_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.save_instance_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance stace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_state</strong> – state to save in</p></li>
<li><p><strong>save_context</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">plumpy.persistence.LoadSaveContext</span></code>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aiida.engine.processes.workchains.workchain.WorkChain.to_context">
<code class="sig-name descname">to_context</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aiida/engine/processes/workchains/workchain.html#WorkChain.to_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.WorkChain.to_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dictionary of awaitables to the context.</p>
<p>This is a convenience method that provides syntactic sugar, for a user to add multiple intersteps that will
assign a certain value to the corresponding key in the context of the work chain.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.workchain.if_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.workchain.</code><code class="sig-name descname">if_</code><span class="sig-paren">(</span><em class="sig-param">condition</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plumpy/workchains.html#if_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.if_" title="Permalink to this definition">¶</a></dt>
<dd><p>A conditional that can be used in a workchain outline.</p>
<p>Use as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">if_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">conditional</span><span class="p">)(</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step1</span><span class="p">,</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step2</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each step can, of course, also be any valid workchain step e.g. conditional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condition</strong> – The workchain method that will return True or False</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aiida.engine.processes.workchains.workchain.while_">
<code class="sig-prename descclassname">aiida.engine.processes.workchains.workchain.</code><code class="sig-name descname">while_</code><span class="sig-paren">(</span><em class="sig-param">condition</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plumpy/workchains.html#while_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aiida.engine.processes.workchains.workchain.while_" title="Permalink to this definition">¶</a></dt>
<dd><p>A while loop that can be used in a workchain outline.</p>
<p>Use as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">while_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">conditional</span><span class="p">)(</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step1</span><span class="p">,</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">step2</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each step can, of course, also be any valid workchain step e.g. conditional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condition</strong> – The workchain method that will return True or False</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>