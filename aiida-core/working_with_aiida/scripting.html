

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Verdi shell &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script src="../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Verdi shell</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/working_with_aiida/scripting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="verdi-shell">
<h1>Verdi shell<a class="headerlink" href="#verdi-shell" title="Permalink to this headline">¶</a></h1>
<p>By running <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">shell</span></code> on the terminal, a new interactive
<a class="reference external" href="http://ipython.org/">IPython</a> shell will be opened (this requires that
IPython is installed on your computer).</p>
<p>Note that simply opening IPython and loading the AiiDA modules will not work
(unless you perform the operations described in the
<a class="reference internal" href="#writing-python-scripts-for-aiida"><span class="std std-ref">following section</span></a>) because
the database settings are not loaded by default and AiiDA does not know how to
access the database.</p>
<p>Moreover, by calling <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">shell</span></code>, you have the additional advantage that
some classes and modules are automatically loaded. In particular the following
modules/classes are already loaded and available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiida.orm</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Code</span><span class="p">,</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Computer</span><span class="p">,</span> <span class="n">Group</span>
<span class="kn">from</span> <span class="nn">aiida.plugins</span> <span class="kn">import</span> <span class="n">DataFactory</span><span class="p">,</span> <span class="n">CalculationFactory</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to customize the shell by adding modules to be loaded
automatically, thanks to the <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">config</span> <span class="pre">verdi.shell.auto_import</span></code> command.</p>
</div>
<p>A further advantage is that bash completion is enabled, allowing to press the
<code class="docutils literal notranslate"><span class="pre">TAB</span></code> key to see available submethods of a given object (see for instance
the documentation of the <a class="reference internal" href="resultmanager.html"><span class="doc">ResultManager</span></a>).</p>
</div>
<div class="section" id="python-scripts">
<span id="writing-python-scripts-for-aiida"></span><h1>Python scripts<a class="headerlink" href="#python-scripts" title="Permalink to this headline">¶</a></h1>
<p>Alternatively, if you do not need an interactive shell but you prefer to write
a script and then launch it from the command line, you can just write a
standard python <code class="docutils literal notranslate"><span class="pre">.py</span></code> file. The only modification that you need to do is
to add, at the beginning of the file and before loading any other AiiDA module,
the following two lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiida</span> <span class="kn">import</span> <span class="n">load_profile</span>
<span class="n">load_profile</span><span class="p">()</span>
</pre></div>
</div>
<p>that will load the database settings and allow AiiDA to reach your database.
Then, you can load as usual python and AiiDA modules and classes, and use them.
If you want to have the same environment of the <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">shell</span></code> interactive
shell, you can also add (below the <code class="docutils literal notranslate"><span class="pre">load_profile</span></code> call) the following lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiida.orm</span> <span class="kn">import</span> <span class="n">Code</span><span class="p">,</span> <span class="n">Computer</span><span class="p">,</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">aiida.plugins</span> <span class="kn">import</span> <span class="n">CalculationFactory</span><span class="p">,</span> <span class="n">DataFactory</span>
</pre></div>
</div>
<p>or simply import the only modules that you will need in the script.</p>
<p>While this method will work, we strongly suggest to use instead the
<code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code> command, described here below.</p>
<div class="section" id="the-verdi-run-command-and-the-runaiida-executable">
<h2>The <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code> command and the <code class="docutils literal notranslate"><span class="pre">runaiida</span></code> executable<a class="headerlink" href="#the-verdi-run-command-and-the-runaiida-executable" title="Permalink to this headline">¶</a></h2>
<p>In order to simplify the procedure described above, it is possible to
execute a python file using <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code>: this command will accept
as parameter the name of a file, and will execute it after having
loaded the modules described above.</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code> has
the additional advantage of adding all stored nodes to suitable special
groups, of type <code class="docutils literal notranslate"><span class="pre">auto.run</span></code>, for later usage.
You can get the list of all these groups with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">group</span> <span class="nb">list</span> <span class="o">-</span><span class="n">t</span> <span class="n">auto</span><span class="o">.</span><span class="n">run</span>
</pre></div>
</div>
<p>Some further command line options of <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code> allow the user
to fine-tune the autogrouping behavior;
for more details, refer to the output of <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span> <span class="pre">-h</span></code>.
Note also that further command line parameters to <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code> are
passed to the script as <code class="docutils literal notranslate"><span class="pre">sys.argv</span></code>.</p>
<p>Finally, we also defined a <code class="docutils literal notranslate"><span class="pre">runaiida</span></code> command, that simply will
pass all its parameters to <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code>. The reason for this is that
one can define a new script to be run with <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">run</span></code>, add as the
first line the shebang command <code class="docutils literal notranslate"><span class="pre">#!/usr/bin/env</span> <span class="pre">runaiida</span></code>, and give
to the file execution permissions, and the file will become an
executable that is run using AiiDA. A simple example could be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env runaiida</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">pk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">load_node</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Node </span><span class="si">{}</span><span class="s2"> is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pk</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">aiida</span>
<span class="nb">print</span> <span class="s2">&quot;AiiDA version is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">aiida</span><span class="o">.</span><span class="n">get_version</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>