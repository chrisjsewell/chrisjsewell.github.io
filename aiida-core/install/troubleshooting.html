

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Troubleshooting &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script src="../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Troubleshooting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/install/troubleshooting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="troubleshooting">
<span id="id1"></span><h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<p>If you experience any problems, first check that all services are up and running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>verdi status

 ✓ profile:     On profile django
 ✓ repository:  /repo/aiida_dev/django
 ✓ postgres:    Connected to aiida@localhost:5432
 ✓ rabbitmq:    Connected to amqp://127.0.0.1?heartbeat<span class="o">=</span><span class="m">600</span>
 ✓ daemon:      Daemon is running as PID <span class="m">2809</span> since <span class="m">2019</span>-03-15 <span class="m">16</span>:27:52
</pre></div>
</div>
<p>In the example output, all service have a green check mark and so should be running as expected.
If all services are up and running and you are still experiencing problems, consider the commonly encountered problems below.</p>
<div class="section" id="installation-phase">
<h2>Installation phase<a class="headerlink" href="#installation-phase" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>[<strong>numpy dependency</strong>] On a clean Ubuntu 16.04 install the pip install command <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">aiida-core</span></code>
may fail due to a problem with dependencies on the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> package. In this case
you may be presented with a message like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.distutils.misc_util</span> <span class="kn">import</span> <span class="n">get_numpy_include_dirs</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">numpy</span><span class="o">.</span><span class="n">distutils</span><span class="o">.</span><span class="n">misc_util</span>
</pre></div>
</div>
<p>To fix this, simply install <code class="docutils literal notranslate"><span class="pre">numpy</span></code> individually through pip in your virtual env, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span>
</pre></div>
</div>
<p>followed by executing the original install command once more:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="n">aiida</span><span class="o">-</span><span class="n">core</span>
</pre></div>
</div>
<p>This should fix the dependency error.</p>
</li>
<li><p>[<strong>Database installation and location</strong>] If the installation fails while installing the packages related
to the database, you may have not installed or set up the database
libraries.</p>
<p>In particular, on Mac OS X, if you installed the binary package of
PostgreSQL, it is possible that the PATH environment variable is not
set correctly, and you get a “Error: pg_config executable not found.” error.
In this case, discover where the binary is located, then add a line to
your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> file similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=/the/path/to/the/pg_config/file:${PATH}
</pre></div>
</div>
<p>and then open a new bash shell.
Some possible paths can be found at this
<a class="reference external" href="http://stackoverflow.com/questions/21079820/how-to-find-pg-config-pathlink">Stackoverflow link</a> and a non-exhaustive list of possible
paths is the following (version number may change):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/Applications/Postgres93.app/Contents/MacOS/bin</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/Applications/Postgres.app/Contents/Versions/9.3/bin</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/Library/PostgreSQL/9.3/bin/pg_config</span></code></p></li>
</ul>
<p>Similarly, if the package installs but then errors occur during the first
of AiiDA (with <code class="docutils literal notranslate"><span class="pre">Symbol</span> <span class="pre">not</span> <span class="pre">found</span></code> errors or similar), you may need to
point to the path where the dynamical libraries are. A way to do it is to
add a line similar to the following to the <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> and then open
a new shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export DYLD_FALLBACK_LIBRARY_PATH=/Library/PostgreSQL/9.3/lib:$DYLD_FALLBACK_LIBRARY_PATH
</pre></div>
</div>
<p>(you should of course adapt the path to the PostgreSQL libraries).</p>
</li>
</ul>
<ul>
<li><p>[<strong>ensuring a UTF-8 locale</strong>]For some reasons, on some machines
(notably often on Mac OS X) there is no
default locale defined, and when you run <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">setup</span></code> for the first
time it fails (see also <a class="reference external" href="https://code.djangoproject.com/ticket/16017">this issue</a> of django).
Run in your terminal (or maybe even better, add to your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, but
then remember to open a new shell window!):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LANG</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span>
<span class="n">export</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span>
</pre></div>
</div>
<p>and then run <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">setup</span></code> again.</p>
</li>
</ul>
<ul>
<li><p>[<strong>possible Ubuntu dependencies</strong>] Several users reported the need to install
also <code class="docutils literal notranslate"><span class="pre">libpq-dev</span></code> (header files for libpq5 - PostgreSQL library):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libpq</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>But under Ubuntu 12.04 this is not needed.</p>
</li>
</ul>
</div>
<div class="section" id="verdi-not-in-path">
<h2>verdi not in PATH<a class="headerlink" href="#verdi-not-in-path" title="Permalink to this headline">¶</a></h2>
<p>Installing the <code class="docutils literal notranslate"><span class="pre">aiida-core</span></code> python package <em>should</em> add the <code class="docutils literal notranslate"><span class="pre">verdi</span></code> CLI to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> automatically.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">verdi</span></code> executable is not available in your terminal, the folder where <code class="docutils literal notranslate"><span class="pre">pip</span></code> places binaries may not be added to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code></p>
<p>For Linux systems, this folder is usually something like <code class="docutils literal notranslate"><span class="pre">~/.local/bin</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=~/.local/bin:${PATH}
</pre></div>
</div>
<p>For Mac OS X systems, the path to add is usually <code class="docutils literal notranslate"><span class="pre">~/Library/Python/2.7/bin</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=~/Library/Python/2.7/bin:${PATH}
</pre></div>
</div>
<p>After updating your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, the <code class="docutils literal notranslate"><span class="pre">verdi</span></code> command should be available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>A preprequisite for <code class="docutils literal notranslate"><span class="pre">verdi</span></code> to work is that the <code class="docutils literal notranslate"><span class="pre">aiida</span></code> python package is importable.
Test this by opening a <code class="docutils literal notranslate"><span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">ipython</span></code> shell and typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">aiida</span>
</pre></div>
</div>
</div></blockquote>
<p>If you get an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> (and you are in the environment where AiiDA was installed),
you can add it to the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{PYTHONPATH}</span><span class="s2">:&lt;AiiDA_folder&gt;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-remote-ssh-computers">
<h2>Configuring remote SSH computers<a class="headerlink" href="#configuring-remote-ssh-computers" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>[<strong>ssh_kerberos installation</strong>] When installing the <code class="docutils literal notranslate"><span class="pre">ssh_kerberos</span></code> <em>optional</em>
requirement through Anaconda you may encounter the following error on Ubuntu machines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">version</span> <span class="s1">&#39;GFORTRAN_1.4&#39;</span> <span class="ow">not</span> <span class="n">found</span> <span class="p">(</span><span class="n">required</span> <span class="n">by</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libblas</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This is related to an open issue in anaconda <a class="reference external" href="https://github.com/ContinuumIO/anaconda-issues/issues/686">ContinuumIO/anaconda-issues#686</a>.
A potential solution is to run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LD_PRELOAD</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libgfortran</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">3</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>[<strong>Output from .bashrc and/or .bash_profile on remote computers</strong>]
(<strong>NOTE</strong> This applies also computers configured via <code class="docutils literal notranslate"><span class="pre">local</span></code> transport!)</p>
<p>When connecting to remote computers, AiiDA (like other codes as <code class="docutils literal notranslate"><span class="pre">sftp</span></code>)
can get confused if you have code in your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> or
<code class="docutils literal notranslate"><span class="pre">.bash_profile</span></code> that produces output or e.g. runs commands like <code class="docutils literal notranslate"><span class="pre">clean</span></code>
that require a terminal.</p>
<p>For instance, if you add a <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;a&quot;</span></code> in your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> and then try to SFTP
a file from it, you will get an error like <code class="docutils literal notranslate"><span class="pre">Received</span> <span class="pre">message</span> <span class="pre">too</span> <span class="pre">long</span> <span class="pre">1091174400</span></code>.</p>
<p>If you still want to have code that needs an interactive shell (<code class="docutils literal notranslate"><span class="pre">echo</span></code>,
<code class="docutils literal notranslate"><span class="pre">clean</span></code>, …), but you want to disable it for non-interactive shells, put
at the top of your file a guard like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if [[ $- != *i* ]] ; then
  # Shell is non-interactive.  Be done now!
  return
fi
</pre></div>
</div>
<p>Everything below this will not be executed in a non-interactive shell.
<strong>Note</strong>: Still, you might want to have some code on top, like e.g. setting the PATH or
similar, if this needs to be run also in the case of non-interactive shells.</p>
<p>To test if a the computer does not produce spurious output, run (after
configuring):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">computer</span> <span class="n">test</span> <span class="o">&lt;</span><span class="n">COMPUTERNAME</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>which checks and, in case of problems, suggests how to solve the problem.
You can track the discussion on this issue in <a class="reference external" href="https://github.com/aiidateam/aiida-core/issues/1890">aiidateam/aiida-core#1890</a>.</p>
</li>
</ul>
</div>
<div class="section" id="improvements-for-dependencies">
<h2>Improvements for dependencies<a class="headerlink" href="#improvements-for-dependencies" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>[<strong>Activating the ASE visualizer</strong>] Within a virtual environment,
attempt to visualize a structure
with <code class="docutils literal notranslate"><span class="pre">ase</span></code> (either from the shell, or using the
command <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">data</span> <span class="pre">structure</span> <span class="pre">show</span> <span class="pre">--format=ase</span> <span class="pre">&lt;PK&gt;</span></code>),
might end up with the following error message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">pygtk</span>
</pre></div>
</div>
<p>The issue is that <code class="docutils literal notranslate"><span class="pre">pygtk</span></code> is currently not pip-installable. One has to install it
separately and create the appropriate bindings manually in the virtual environment.
You can follow the following procedure to get around this issue:</p>
<ul>
<li><p>Install the <code class="docutils literal notranslate"><span class="pre">python-gtk2</span></code> package. Under Ubuntu, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">gtk2</span>
</pre></div>
</div>
</li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">lib/python2.7/dist-packages</span></code> folder within your virtual
environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">&lt;</span><span class="n">AIIDA_VENV_FOLDER</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
<span class="n">chmod</span> <span class="mi">755</span> <span class="o">&lt;</span><span class="n">AIIDA_VENV_FOLDER</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;AIIDA_VENV_FOLDER&gt;</span></code> is the virtual environment folder you have created
during the installation process.</p>
</li>
<li><p>Create several symbolic links from this folder, pointing to a number of files
in <code class="docutils literal notranslate"><span class="pre">/usr/lib/python2.7/dist-packages/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">AIIDA_VENV_FOLDER</span><span class="o">&gt;/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">glib</span> <span class="n">glib</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">gobject</span> <span class="n">gobject</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">gtk</span><span class="o">-</span><span class="mf">2.0</span> <span class="n">gtk</span><span class="o">-</span><span class="mf">2.0</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pygtk</span><span class="o">.</span><span class="n">pth</span> <span class="n">pygtk</span><span class="o">.</span><span class="n">pth</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pygtk</span><span class="o">.</span><span class="n">py</span> <span class="n">pygtk</span><span class="o">.</span><span class="n">py</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">cairo</span> <span class="n">cairo</span>
</pre></div>
</div>
</li>
</ul>
<p>After that, <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">data</span> <span class="pre">structure</span> <span class="pre">show</span> <span class="pre">--format=ase</span> <span class="pre">&lt;PK&gt;</span></code> should work.</p>
</li>
</ul>
</div>
<div class="section" id="use-in-ipython-jupyter">
<h2>Use in ipython/jupyter<a class="headerlink" href="#use-in-ipython-jupyter" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>In order to use the AiiDA objects and functions in Jupyter, this latter has to be instructed to use the iPython kernel installed in the AiiDA virtual environment. This happens by default if you install AiiDA with <code class="docutils literal notranslate"><span class="pre">pip</span></code> including the <code class="docutils literal notranslate"><span class="pre">notebook</span></code> option and run Jupyter from the AiiDA virtual environment.</p>
<p>If, for any reason, you do not want to install Jupyter in the virtual environment, you might consider to install it out of the virtual environment, if not already done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jupyter</span>
</pre></div>
</div>
<p>Then, activate the AiiDA virtual environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">~/&lt;</span><span class="n">aiida</span><span class="o">.</span><span class="n">virtualenv</span><span class="o">&gt;/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>and setup the AiiDA iPython kernel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ipykernel</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">ipykernel</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span> <span class="o">--</span><span class="n">name</span><span class="o">=&lt;</span><span class="n">aiida</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where you have chosen a meaningful name for the new kernel.</p>
<p>Finally, start a Jupyter server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">notebook</span>
</pre></div>
</div>
<p>and from the newly opened browser tab select <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">-&gt;</span> <span class="pre">&lt;aiida.kernel.name&gt;</span></code></p>
</li>
</ul>
</div>
<div class="section" id="postgres-restart-problem">
<h2>Postgres restart problem<a class="headerlink" href="#postgres-restart-problem" title="Permalink to this headline">¶</a></h2>
<p>Due to a <cite>bug &lt;https://wiki.postgresql.org/wiki/May_2015_Fsync_Permissions_Bug&gt;</cite> affecting older postgres versions (&lt;9.4),
PostgreSQL could refuse to restart after a crash or after a restore from binary backup.</p>
<p>The error message would be something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Starting</span> <span class="n">PostgreSQL</span> <span class="mf">9.1</span> <span class="n">database</span> <span class="n">server</span>
<span class="o">*</span> <span class="n">The</span> <span class="n">PostgreSQL</span> <span class="n">server</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">start</span><span class="o">.</span> <span class="n">Please</span> <span class="n">check</span> <span class="n">the</span> <span class="n">log</span> <span class="n">output</span><span class="p">:</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">26</span> <span class="mi">03</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">20</span> <span class="n">UTC</span> <span class="p">[</span><span class="mi">331</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="n">LOG</span><span class="p">:</span>  <span class="n">database</span> <span class="n">system</span> <span class="n">was</span> <span class="n">interrupted</span><span class="p">;</span> <span class="n">last</span> <span class="n">known</span> <span class="n">up</span> <span class="n">at</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">21</span> <span class="mi">19</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">58</span> <span class="n">UTC</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">26</span> <span class="mi">03</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">20</span> <span class="n">UTC</span> <span class="p">[</span><span class="mi">331</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">FATAL</span><span class="p">:</span>  <span class="n">could</span> <span class="ow">not</span> <span class="nb">open</span> <span class="n">file</span> <span class="s2">&quot;/etc/ssl/certs/ssl-cert-snakeoil.pem&quot;</span><span class="p">:</span> <span class="n">Permission</span> <span class="n">denied</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">26</span> <span class="mi">03</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">20</span> <span class="n">UTC</span> <span class="p">[</span><span class="mi">330</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="n">LOG</span><span class="p">:</span>  <span class="n">startup</span> <span class="n">process</span> <span class="p">(</span><span class="n">PID</span> <span class="mi">331</span><span class="p">)</span> <span class="n">exited</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">26</span> <span class="mi">03</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">20</span> <span class="n">UTC</span> <span class="p">[</span><span class="mi">330</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">LOG</span><span class="p">:</span>  <span class="n">aborting</span> <span class="n">startup</span> <span class="n">due</span> <span class="n">to</span> <span class="n">startup</span> <span class="n">process</span> <span class="n">failure</span>
</pre></div>
</div>
<p>If this happens you should change the permissions on any symlinked files
to being writable by the Postgres user. For example, on Ubuntu, with PostgreSQL 9.1,
the following should work (<strong>WARNING</strong>: Make sure these configuration files are
symbolic links before executing these commands! If someone has customized the server.crt
or server.key file, you can erase them by following these steps.
It’s a good idea to make a backup of the server.crt and server.key files before removing them):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">as</span> <span class="n">root</span><span class="p">)</span>
<span class="c1"># go to PGDATA directory</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mf">9.1</span><span class="o">/</span><span class="n">main</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">server</span><span class="o">.</span><span class="n">crt</span> <span class="n">server</span><span class="o">.</span><span class="n">key</span>
<span class="c1"># confirm both of those files are symbolic links</span>
<span class="c1"># to files in /etc/ssl before going further</span>
<span class="c1"># remove symlinks to SSL certs</span>
<span class="n">rm</span> <span class="n">server</span><span class="o">.</span><span class="n">crt</span>
<span class="n">rm</span> <span class="n">server</span><span class="o">.</span><span class="n">key</span>
<span class="c1"># copy the SSL certs to the local directory</span>
<span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">snakeoil</span><span class="o">.</span><span class="n">pem</span> <span class="n">server</span><span class="o">.</span><span class="n">crt</span>
<span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">snakeoil</span><span class="o">.</span><span class="n">key</span> <span class="n">server</span><span class="o">.</span><span class="n">key</span>
<span class="c1"># set permissions on ssl certs</span>
<span class="c1"># and postgres ownership on everything else</span>
<span class="c1"># just in case</span>
<span class="n">chown</span> <span class="n">postgres</span> <span class="o">*</span>
<span class="n">chmod</span> <span class="mi">640</span> <span class="n">server</span><span class="o">.</span><span class="n">crt</span> <span class="n">server</span><span class="o">.</span><span class="n">key</span>

<span class="n">service</span> <span class="n">postgresql</span> <span class="n">start</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>