

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.orm.nodes.process.process &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/togglebutton.js"></script>
        <script src="../../../../../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../../aiida.html">aiida</a> &raquo;</li>
        
      <li>aiida.orm.nodes.process.process</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida.orm.nodes.process.process</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###########################################################################</span>
<span class="c1"># Copyright (c), The AiiDA team. All rights reserved.                     #</span>
<span class="c1"># This file is part of the AiiDA code.                                    #</span>
<span class="c1">#                                                                         #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/aiidateam/aiida-core #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file        #</span>
<span class="c1"># For further information please visit http://www.aiida.net               #</span>
<span class="c1">###########################################################################</span>
<span class="sd">&quot;&quot;&quot;Module with `Node` sub class for processes.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">enum</span>

<span class="kn">from</span> <span class="nn">plumpy</span> <span class="kn">import</span> <span class="n">ProcessState</span>

<span class="kn">from</span> <span class="nn">aiida.common.links</span> <span class="kn">import</span> <span class="n">LinkType</span>
<span class="kn">from</span> <span class="nn">aiida.common.lang</span> <span class="kn">import</span> <span class="n">classproperty</span>
<span class="kn">from</span> <span class="nn">aiida.orm.utils.mixins</span> <span class="kn">import</span> <span class="n">Sealable</span>

<span class="kn">from</span> <span class="nn">..node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ProcessNode&#39;</span><span class="p">,)</span>


<div class="viewcode-block" id="ProcessNode"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode">[docs]</a><span class="k">class</span> <span class="nc">ProcessNode</span><span class="p">(</span><span class="n">Sealable</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for all nodes representing the execution of a process</span>

<span class="sd">    This class and its subclasses serve as proxies in the database, for actual `Process` instances being run. The</span>
<span class="sd">    `Process` instance in memory will leverage an instance of this class (the exact sub class depends on the sub class</span>
<span class="sd">    of `Process`) to persist important information of its state to the database. This serves as a way for the user to</span>
<span class="sd">    inspect the state of the `Process` during its execution as well as a permanent record of its execution in the</span>
<span class="sd">    provenance graph, after the execution has terminated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=too-many-public-methods,abstract-method</span>

    <span class="n">CHECKPOINT_KEY</span> <span class="o">=</span> <span class="s1">&#39;checkpoints&#39;</span>
    <span class="n">EXCEPTION_KEY</span> <span class="o">=</span> <span class="s1">&#39;exception&#39;</span>
    <span class="n">EXIT_MESSAGE_KEY</span> <span class="o">=</span> <span class="s1">&#39;exit_message&#39;</span>
    <span class="n">EXIT_STATUS_KEY</span> <span class="o">=</span> <span class="s1">&#39;exit_status&#39;</span>
    <span class="n">PROCESS_PAUSED_KEY</span> <span class="o">=</span> <span class="s1">&#39;paused&#39;</span>
    <span class="n">PROCESS_LABEL_KEY</span> <span class="o">=</span> <span class="s1">&#39;process_label&#39;</span>
    <span class="n">PROCESS_STATE_KEY</span> <span class="o">=</span> <span class="s1">&#39;process_state&#39;</span>
    <span class="n">PROCESS_STATUS_KEY</span> <span class="o">=</span> <span class="s1">&#39;process_status&#39;</span>

    <span class="c1"># The link_type might not be correct while the object is being created.</span>
    <span class="n">_hash_ignored_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CALL_CALC&#39;</span><span class="p">,</span> <span class="s1">&#39;CALL_WORK&#39;</span><span class="p">]</span>

    <span class="n">_unstorable_message</span> <span class="o">=</span> <span class="s1">&#39;only Data, WorkflowNode, CalculationNode or their subclasses can be stored&#39;</span>

<div class="viewcode-block" id="ProcessNode.__str__"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.__str__">[docs]</a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base</span><span class="p">)</span></div>

    <span class="nd">@classproperty</span>
    <span class="k">def</span> <span class="nf">_updatable_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="c1"># pylint: disable=no-self-argument</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_updatable_attributes</span> <span class="o">+</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">PROCESS_PAUSED_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">CHECKPOINT_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">EXCEPTION_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">EXIT_MESSAGE_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">EXIT_STATUS_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">PROCESS_LABEL_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">PROCESS_STATE_KEY</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">PROCESS_STATUS_KEY</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the logger of the Calculation object, so that it also logs to the DB.</span>

<span class="sd">        :return: LoggerAdapter object, that works like a logger, but also has the &#39;extra&#39; embedded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">aiida.orm.utils.log</span> <span class="kn">import</span> <span class="n">create_logger_adapter</span>
        <span class="k">return</span> <span class="n">create_logger_adapter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.get_builder_restart"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.get_builder_restart">[docs]</a>    <span class="k">def</span> <span class="nf">get_builder_restart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a `ProcessBuilder` that is ready to relaunch the process that created this node.</span>

<span class="sd">        The process class will be set based on the `process_type` of this node and the inputs of the builder will be</span>
<span class="sd">        prepopulated with the inputs registered for this node. This functionality is very useful if a process has</span>
<span class="sd">        completed and you want to relaunch it with slightly different inputs.</span>

<span class="sd">        :return: `~aiida.engine.processes.builder.ProcessBuilder` instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_class</span><span class="o">.</span><span class="n">get_builder</span><span class="p">()</span>
        <span class="n">builder</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_incoming</span><span class="p">(</span><span class="n">link_type</span><span class="o">=</span><span class="p">(</span><span class="n">LinkType</span><span class="o">.</span><span class="n">INPUT_CALC</span><span class="p">,</span> <span class="n">LinkType</span><span class="o">.</span><span class="n">INPUT_WORK</span><span class="p">))</span><span class="o">.</span><span class="n">nested</span><span class="p">())</span>  <span class="c1"># pylint: disable=protected-access</span>

        <span class="k">return</span> <span class="n">builder</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">process_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the process class that was used to create this node.</span>

<span class="sd">        :return: `Process` class</span>
<span class="sd">        :raises ValueError: if no process type is defined, it is an invalid process type string or cannot be resolved</span>
<span class="sd">            to load the corresponding class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">aiida.common</span> <span class="kn">import</span> <span class="n">exceptions</span>
        <span class="kn">from</span> <span class="nn">aiida.plugins.entry_point</span> <span class="kn">import</span> <span class="n">load_entry_point_from_string</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;no process type for CalcJobNode&lt;</span><span class="si">{}</span><span class="s1">&gt;: cannot recreate process class&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">process_class</span> <span class="o">=</span> <span class="n">load_entry_point_from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">EntryPointError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;could not load process class for entry point </span><span class="si">{}</span><span class="s1"> for CalcJobNode&lt;</span><span class="si">{}</span><span class="s1">&gt;: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="p">,</span> <span class="n">exception</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">importlib</span>
                <span class="n">module_name</span><span class="p">,</span> <span class="n">class_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
                <span class="n">process_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;could not load process class CalcJobNode&lt;</span><span class="si">{}</span><span class="s1">&gt; given its `process_type`: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">process_class</span>

<div class="viewcode-block" id="ProcessNode.set_process_type"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_process_type">[docs]</a>    <span class="k">def</span> <span class="nf">set_process_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_type_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the process type string.</span>

<span class="sd">        :param process_type: the process type string identifying the class using this process node as storage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="n">process_type_string</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">process_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the process label</span>

<span class="sd">        :returns: the process label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_LABEL_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_process_label"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_process_label">[docs]</a>    <span class="k">def</span> <span class="nf">set_process_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the process label</span>

<span class="sd">        :param label: process label string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_LABEL_KEY</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">process_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the process state</span>

<span class="sd">        :returns: the process state instance of ProcessState enum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_STATE_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">state</span>

        <span class="k">return</span> <span class="n">ProcessState</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_process_state"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_process_state">[docs]</a>    <span class="k">def</span> <span class="nf">set_process_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the process state</span>

<span class="sd">        :param state: value or instance of ProcessState enum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ProcessState</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_STATE_KEY</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">process_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the process status</span>

<span class="sd">        The process status is a generic status message e.g. the reason it might be paused or when it is being killed</span>

<span class="sd">        :returns: the process status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_STATUS_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_process_status"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_process_status">[docs]</a>    <span class="k">def</span> <span class="nf">set_process_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the process status</span>

<span class="sd">        The process status is a generic status message e.g. the reason it might be paused or when it is being killed.</span>
<span class="sd">        If status is None, the corresponding attribute will be deleted.</span>

<span class="sd">        :param status: string process status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_STATUS_KEY</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;process status should be a string&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_STATUS_KEY</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_terminated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process has terminated</span>

<span class="sd">        Terminated means that the process has reached any terminal state.</span>

<span class="sd">        :return: True if the process has terminated, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excepted</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_killed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_excepted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process has excepted</span>

<span class="sd">        Excepted means that during execution of the process, an exception was raised that was not caught.</span>

<span class="sd">        :return: True if during execution of the process an exception occurred, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_state</span> <span class="o">==</span> <span class="n">ProcessState</span><span class="o">.</span><span class="n">EXCEPTED</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_killed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process was killed</span>

<span class="sd">        Killed means the process was killed directly by the user or by the calling process being killed.</span>

<span class="sd">        :return: True if the process was killed, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_state</span> <span class="o">==</span> <span class="n">ProcessState</span><span class="o">.</span><span class="n">KILLED</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process has finished</span>

<span class="sd">        Finished means that the process reached a terminal state nominally.</span>
<span class="sd">        Note that this does not necessarily mean successfully, but there were no exceptions and it was not killed.</span>

<span class="sd">        :return: True if the process has finished, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_state</span> <span class="o">==</span> <span class="n">ProcessState</span><span class="o">.</span><span class="n">FINISHED</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_finished_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process has finished successfully</span>

<span class="sd">        Finished successfully means that it terminated nominally and had a zero exit status.</span>

<span class="sd">        :return: True if the process has finished successfully, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit_status</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process has failed</span>

<span class="sd">        Failed means that the process terminated nominally but it had a non-zero exit status.</span>

<span class="sd">        :return: True if the process has failed, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit_status</span> <span class="o">!=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the exit status of the process</span>

<span class="sd">        :returns: the exit status, an integer exit code or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXIT_STATUS_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_exit_status"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_exit_status">[docs]</a>    <span class="k">def</span> <span class="nf">set_exit_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the exit status of the process</span>

<span class="sd">        :param state: an integer exit code or None, which will be interpreted as zero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">value</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;exit status has to be an integer, got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXIT_STATUS_KEY</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the exit message of the process</span>

<span class="sd">        :returns: the exit message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXIT_MESSAGE_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_exit_message"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_exit_message">[docs]</a>    <span class="k">def</span> <span class="nf">set_exit_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the exit message of the process, if None nothing will be done</span>

<span class="sd">        :param message: a string message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;exit message has to be a string type, got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">message</span><span class="p">)))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXIT_MESSAGE_KEY</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exception</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the exception of the process or None if the process is not excepted.</span>

<span class="sd">        If the process is marked as excepted yet there is no exception attribute, an empty string will be returned.</span>

<span class="sd">        :returns: the exception message or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excepted</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXCEPTION_KEY</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="ProcessNode.set_exception"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_exception">[docs]</a>    <span class="k">def</span> <span class="nf">set_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the exception of the process</span>

<span class="sd">        :param exception: the exception message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;exception message has to be a string type, got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exception</span><span class="p">)))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EXCEPTION_KEY</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the checkpoint bundle set for the process</span>

<span class="sd">        :returns: checkpoint bundle if it exists, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHECKPOINT_KEY</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.set_checkpoint"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.set_checkpoint">[docs]</a>    <span class="k">def</span> <span class="nf">set_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the checkpoint bundle set for the process</span>

<span class="sd">        :param state: string representation of the stepper state info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHECKPOINT_KEY</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProcessNode.delete_checkpoint"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.delete_checkpoint">[docs]</a>    <span class="k">def</span> <span class="nf">delete_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the checkpoint bundle set for the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHECKPOINT_KEY</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">paused</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the process is paused</span>

<span class="sd">        :returns: True if the Calculation is marked as paused, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_PAUSED_KEY</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode.pause"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.pause">[docs]</a>    <span class="k">def</span> <span class="nf">pause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mark the process as paused by setting the corresponding attribute.</span>

<span class="sd">        This serves only to reflect that the corresponding Process is paused and so this method should not be called</span>
<span class="sd">        by anyone but the Process instance itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_PAUSED_KEY</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProcessNode.unpause"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.unpause">[docs]</a>    <span class="k">def</span> <span class="nf">unpause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mark the process as unpaused by removing the corresponding attribute.</span>

<span class="sd">        This serves only to reflect that the corresponding Process is unpaused and so this method should not be called</span>
<span class="sd">        by anyone but the Process instance itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PROCESS_PAUSED_KEY</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">called</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of nodes that the process called</span>

<span class="sd">        :returns: list of process nodes called by this process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_outgoing</span><span class="p">(</span><span class="n">link_type</span><span class="o">=</span><span class="p">(</span><span class="n">LinkType</span><span class="o">.</span><span class="n">CALL_CALC</span><span class="p">,</span> <span class="n">LinkType</span><span class="o">.</span><span class="n">CALL_WORK</span><span class="p">))</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">called_descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of all nodes that have been called downstream of this process</span>

<span class="sd">        This will recursively find all the called processes for this process and its children.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">descendants</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">descendant</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">called</span><span class="p">:</span>
            <span class="n">descendants</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descendant</span><span class="p">)</span>
            <span class="n">descendants</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">descendant</span><span class="o">.</span><span class="n">called_descendants</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">descendants</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">caller</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the process node that called this process node, or None if it does not have a caller</span>

<span class="sd">        :returns: process node that called this process node instance or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">caller</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_incoming</span><span class="p">(</span><span class="n">link_type</span><span class="o">=</span><span class="p">(</span><span class="n">LinkType</span><span class="o">.</span><span class="n">CALL_CALC</span><span class="p">,</span> <span class="n">LinkType</span><span class="o">.</span><span class="n">CALL_WORK</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span><span class="o">.</span><span class="n">node</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">caller</span>

<div class="viewcode-block" id="ProcessNode.validate_incoming"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode.validate_incoming">[docs]</a>    <span class="k">def</span> <span class="nf">validate_incoming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">link_type</span><span class="p">,</span> <span class="n">link_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate adding a link of the given type from a given node to ourself.</span>

<span class="sd">        Adding an input link to a `ProcessNode` once it is stored is illegal because this should be taken care of</span>
<span class="sd">        by the engine in one go. If a link is being added after the node is stored, it is most likely not by the engine</span>
<span class="sd">        and it should not be allowed.</span>

<span class="sd">        :param source: the node from which the link is coming</span>
<span class="sd">        :param link_type: the link type</span>
<span class="sd">        :param link_label: the link label</span>
<span class="sd">        :raise TypeError: if `source` is not a Node instance or `link_type` is not a `LinkType` enum</span>
<span class="sd">        :raise ValueError: if the proposed link is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate_incoming</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">link_type</span><span class="p">,</span> <span class="n">link_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_stored</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;attempted to add an input link after the process node was already stored.&#39;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_valid_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the node is valid for caching</span>

<span class="sd">        :returns: True if this process node is valid to be used for caching, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_valid_cache</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">process_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_class</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Not considering </span><span class="si">{}</span><span class="s2"> for caching, &#39;</span><span class="si">{!r}</span><span class="s2">&#39; when accessing its process class.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># For process functions, the `process_class` does not have an</span>
        <span class="c1"># is_valid_cache attribute</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">is_valid_cache_func</span> <span class="o">=</span> <span class="n">process_class</span><span class="o">.</span><span class="n">is_valid_cache</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">is_valid_cache_func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="ProcessNode._get_objects_to_hash"><a class="viewcode-back" href="../../../../../apidoc/aiida.orm.nodes.process.html#aiida.engine.ProcessNode._get_objects_to_hash">[docs]</a>    <span class="k">def</span> <span class="nf">_get_objects_to_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of objects which should be included in the hash.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_get_objects_to_hash</span><span class="p">()</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="n">entry</span><span class="o">.</span><span class="n">link_label</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_hash</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_incoming</span><span class="p">(</span><span class="n">link_type</span><span class="o">=</span><span class="p">(</span><span class="n">LinkType</span><span class="o">.</span><span class="n">INPUT_CALC</span><span class="p">,</span> <span class="n">LinkType</span><span class="o">.</span><span class="n">INPUT_WORK</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">link_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash_ignored_inputs</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="n">res</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>