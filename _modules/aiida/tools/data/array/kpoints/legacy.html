

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.tools.data.array.kpoints.legacy &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/togglebutton.js"></script>
        <script src="../../../../../../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../../../aiida.html">aiida</a> &raquo;</li>
        
          <li><a href="../kpoints.html">aiida.tools.data.array.kpoints</a> &raquo;</li>
        
      <li>aiida.tools.data.array.kpoints.legacy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida.tools.data.array.kpoints.legacy</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###########################################################################</span>
<span class="c1"># Copyright (c), The AiiDA team. All rights reserved.                     #</span>
<span class="c1"># This file is part of the AiiDA code.                                    #</span>
<span class="c1">#                                                                         #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/aiidateam/aiida-core #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file        #</span>
<span class="c1"># For further information please visit http://www.aiida.net               #</span>
<span class="c1">###########################################################################</span>

<span class="kn">import</span> <span class="nn">numpy</span>


<span class="n">_default_epsilon_length</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">_default_epsilon_angle</span> <span class="o">=</span> <span class="mf">1e-5</span>


<div class="viewcode-block" id="change_reference"><a class="viewcode-back" href="../../../../../../apidoc/aiida.tools.data.array.kpoints.html#aiida.tools.data.array.kpoints.legacy.change_reference">[docs]</a><span class="k">def</span> <span class="nf">change_reference</span><span class="p">(</span><span class="n">reciprocal_cell</span><span class="p">,</span> <span class="n">kpoints</span><span class="p">,</span> <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change reference system, from cartesian to crystal coordinates (units of b1,b2,b3) or viceversa.</span>

<span class="sd">    :param reciprocal_cell: a 3x3 array representing the cell lattice vectors in reciprocal space</span>
<span class="sd">    :param kpoints: a list of (3) point coordinates</span>
<span class="sd">    :return kpoints: a list of (3) point coordinates in the new reference</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpoints</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kpoints must be a numpy.array&#39;</span><span class="p">)</span>

    <span class="n">transposed_cell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">reciprocal_cell</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">to_cartesian</span><span class="p">:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">transposed_cell</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">transposed_cell</span><span class="p">)</span>

    <span class="c1"># note: kpoints is a list Nx3, matrix is 3x3.</span>
    <span class="c1"># hence, first transpose kpoints, then multiply, finally transpose it back</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">kpoints</span><span class="p">)))</span></div>

<div class="viewcode-block" id="analyze_cell"><a class="viewcode-back" href="../../../../../../apidoc/aiida.tools.data.array.kpoints.html#aiida.tools.data.array.kpoints.legacy.analyze_cell">[docs]</a><span class="k">def</span> <span class="nf">analyze_cell</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function executed by the __init__ or by set_cell.</span>
<span class="sd">    If a cell is set, properties like a1, a2, a3, cosalpha, reciprocal_cell are</span>
<span class="sd">    set as well, although they are not stored in the DB.</span>
<span class="sd">    :note: units are Angstrom for the cell parameters, 1/Angstrom for the</span>
<span class="sd">    reciprocal cell parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pbc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pbc</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

    <span class="n">dimension</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pbc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;reciprocal_cell&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;dimension&#39;</span><span class="p">:</span> <span class="n">dimension</span><span class="p">,</span>
            <span class="s1">&#39;pbc&#39;</span><span class="p">:</span> <span class="n">pbc</span>
        <span class="p">}</span>

    <span class="n">the_cell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">reciprocal_cell</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">the_cell</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">the_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">the_cell</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">the_cell</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>  <span class="c1"># units = Angstrom</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">reciprocal_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># units = 1/Angstrom</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">reciprocal_cell</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># units = 1/Angstrom</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="n">reciprocal_cell</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># units = 1/Angstrom</span>
    <span class="n">cosalpha</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span> <span class="o">/</span> <span class="n">c</span>
    <span class="n">cosbeta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span> <span class="o">/</span> <span class="n">a</span>
    <span class="n">cosgamma</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>


    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;a1&#39;</span><span class="p">:</span> <span class="n">a1</span><span class="p">,</span>
        <span class="s1">&#39;a2&#39;</span><span class="p">:</span> <span class="n">a2</span><span class="p">,</span>
        <span class="s1">&#39;a3&#39;</span><span class="p">:</span> <span class="n">a3</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span>
        <span class="s1">&#39;b1&#39;</span><span class="p">:</span> <span class="n">b1</span><span class="p">,</span>
        <span class="s1">&#39;b2&#39;</span><span class="p">:</span> <span class="n">b2</span><span class="p">,</span>
        <span class="s1">&#39;b3&#39;</span><span class="p">:</span> <span class="n">b3</span><span class="p">,</span>
        <span class="s1">&#39;cosalpha&#39;</span><span class="p">:</span> <span class="n">cosalpha</span><span class="p">,</span>
        <span class="s1">&#39;cosbeta&#39;</span><span class="p">:</span> <span class="n">cosbeta</span><span class="p">,</span>
        <span class="s1">&#39;cosgamma&#39;</span><span class="p">:</span> <span class="n">cosgamma</span><span class="p">,</span>
        <span class="s1">&#39;dimension&#39;</span><span class="p">:</span> <span class="n">dimension</span><span class="p">,</span>
        <span class="s1">&#39;reciprocal_cell&#39;</span><span class="p">:</span> <span class="n">reciprocal_cell</span><span class="p">,</span>
        <span class="s1">&#39;pbc&#39;</span><span class="p">:</span> <span class="n">pbc</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="get_explicit_kpoints_path"><a class="viewcode-back" href="../../../../../../apidoc/aiida.tools.data.array.kpoints.html#aiida.tools.data.array.kpoints.legacy.get_explicit_kpoints_path">[docs]</a><span class="k">def</span> <span class="nf">get_explicit_kpoints_path</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kpoint_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">epsilon_length</span><span class="o">=</span><span class="n">_default_epsilon_length</span><span class="p">,</span>
                     <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">_default_epsilon_angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set a path of kpoints in the Brillouin zone.</span>

<span class="sd">    :param value: description of the path, in various possible formats.</span>

<span class="sd">        None: automatically sets all irreducible high symmetry paths.</span>
<span class="sd">        Requires that a cell was set</span>

<span class="sd">        or::</span>

<span class="sd">          [(&#39;G&#39;,&#39;M&#39;), (...), ...]</span>
<span class="sd">          [(&#39;G&#39;,&#39;M&#39;,30), (...), ...]</span>
<span class="sd">          [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1)), (...), ...]</span>
<span class="sd">          [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1),30), (...), ...]</span>

<span class="sd">    :param cell: 3x3 array representing the structure cell lattice vectors</span>
<span class="sd">    :param pbc: 3-dimensional array of booleans signifying the periodic boundary</span>
<span class="sd">        conditions along each lattice vector</span>
<span class="sd">    :param float kpoint_distance: parameter controlling the distance between</span>
<span class="sd">        kpoints. Distance is given in crystal coordinates, i.e. the distance</span>
<span class="sd">        is computed in the space of b1,b2,b3. The distance set will be the</span>
<span class="sd">        closest possible to this value, compatible with the requirement of</span>
<span class="sd">        putting equispaced points between two special points (since extrema</span>
<span class="sd">        are included).</span>
<span class="sd">    :param bool cartesian: if set to true, reads the coordinates eventually</span>
<span class="sd">        passed in value as cartesian coordinates. Default: False.</span>
<span class="sd">    :param float epsilon_length: threshold on lengths comparison, used</span>
<span class="sd">        to get the bravais lattice info. It has to be used if the</span>
<span class="sd">        user wants to be sure the right symmetries are recognized.</span>
<span class="sd">    :param float epsilon_angle: threshold on angles comparison, used</span>
<span class="sd">        to get the bravais lattice info. It has to be used if the</span>
<span class="sd">        user wants to be sure the right symmetries are recognized.</span>

<span class="sd">    :returns: point_coordinates, path, bravais_info, explicit_kpoints, labels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bravais_info</span> <span class="o">=</span> <span class="n">find_bravais_info</span><span class="p">(</span>
        <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="n">pbc</span><span class="p">,</span>
        <span class="n">epsilon_length</span><span class="o">=</span><span class="n">epsilon_length</span><span class="p">,</span>
        <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">epsilon_angle</span>
    <span class="p">)</span>

    <span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="p">)</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;dimension&#39;</span><span class="p">]</span>
    <span class="n">reciprocal_cell</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;reciprocal_cell&#39;</span><span class="p">]</span>
    <span class="n">pbc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;pbc&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># case with zero dimension: only gamma-point is set</span>
        <span class="k">return</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bravais_info</span>

    <span class="k">def</span> <span class="nf">_is_path_1</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">are_two</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_two</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">are_str</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">are_str</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_is_path_2</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">are_three</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_three</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">are_good</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
                                 <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
                                 <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">)])</span>
                            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_good</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># check that at least two points per segment (beginning and end)</span>
            <span class="n">points_num</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">points_num</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must set at least two points per path &#39;</span>
                                 <span class="s1">&#39;segment&#39;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_is_path_3</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="c1"># [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1)), (...), ...]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">are_four</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_four</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">have_labels</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">str</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">have_labels</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">coord1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">coord2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_is_path_4</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="c1"># [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1),30), (...), ...]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">are_five</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_five</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">have_labels</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">str</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">have_labels</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">have_points_num</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">have_points_num</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="c1"># check that at least two points per segment (beginning and end)</span>
            <span class="n">points_num</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">points_num</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must set at least two points per path &#39;</span>
                                 <span class="s1">&#39;segment&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">coord1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">coord2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_num_points_from_coordinates</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">kpoint_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># NOTE: this way of creating intervals ensures equispaced objects</span>
        <span class="c1">#       in crystal coordinates of b1,b2,b3</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">point_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">-</span>
                                       <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">point_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                                       <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">kpoint_distance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Use max_points_per_interval as the default guess for automatically</span>
            <span class="c1"># guessing the number of points</span>
            <span class="n">max_point_per_interval</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">max_interval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">points_per_piece</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_point_per_interval</span> <span class="o">*</span> <span class="n">i</span> <span class="o">//</span> <span class="n">max_interval</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The beginning and end of each segment in the &#39;</span>
                                 <span class="s1">&#39;path should be different.&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">points_per_piece</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">distance</span> <span class="o">//</span> <span class="n">kpoint_distance</span><span class="p">))</span> <span class="k">for</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">points_per_piece</span>

    <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;To use cartesian coordinates, a cell must &#39;</span>
                             <span class="s1">&#39;be provided&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">kpoint_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kpoint_distance</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kpoints_distance must be a positive float&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot set a path not even knowing the &#39;</span>
                             <span class="s1">&#39;kpoints or at least the cell&#39;</span><span class="p">)</span>
        <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">bravais_info</span> <span class="o">=</span> <span class="n">get_kpoints_path</span><span class="p">(</span>
            <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="n">pbc</span><span class="p">,</span> <span class="n">cartesian</span><span class="o">=</span><span class="n">cartesian</span><span class="p">,</span>
            <span class="n">epsilon_length</span><span class="o">=</span><span class="n">epsilon_length</span><span class="p">,</span>
            <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">epsilon_angle</span><span class="p">)</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="n">_num_points_from_coordinates</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">kpoint_distance</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">_is_path_1</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="c1"># in the form [(&#39;X&#39;,&#39;M&#39;),(...),...]</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot set a path not even knowing the &#39;</span>
                             <span class="s1">&#39;kpoints or at least the cell&#39;</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">bravais_info</span> <span class="o">=</span> <span class="n">get_kpoints_path</span><span class="p">(</span>
            <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="n">pbc</span><span class="p">,</span> <span class="n">cartesian</span><span class="o">=</span><span class="n">cartesian</span><span class="p">,</span>
            <span class="n">epsilon_length</span><span class="o">=</span><span class="n">epsilon_length</span><span class="p">,</span>
            <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">epsilon_angle</span><span class="p">)</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="n">_num_points_from_coordinates</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">kpoint_distance</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">_is_path_2</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="c1"># [(&#39;G&#39;,&#39;M&#39;,30), (...), ...]</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot set a path not even knowing the &#39;</span>
                             <span class="s1">&#39;kpoints or at least the cell&#39;</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
        <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">bravais_info</span> <span class="o">=</span> <span class="n">get_kpoints_path</span><span class="p">(</span>
            <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="n">pbc</span><span class="p">,</span> <span class="n">cartesian</span><span class="o">=</span><span class="n">cartesian</span><span class="p">,</span>
            <span class="n">epsilon_length</span><span class="o">=</span><span class="n">epsilon_length</span><span class="p">,</span>
            <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">epsilon_angle</span><span class="p">)</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">_is_path_3</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="c1"># [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1)), (...), ...]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>

        <span class="n">point_coordinates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">point_coordinates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different points cannot have the same label&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">change_reference</span><span class="p">(</span>
                        <span class="n">reciprocal_cell</span><span class="p">,</span>
                        <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span>
                        <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">point_coordinates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different points cannot have the same label&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">change_reference</span><span class="p">(</span>
                        <span class="n">reciprocal_cell</span><span class="p">,</span>
                        <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]]),</span>
                        <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="n">num_points</span> <span class="o">=</span> <span class="n">_num_points_from_coordinates</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">kpoint_distance</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">_is_path_4</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="c1"># [(&#39;G&#39;,(0,0,0),&#39;M&#39;,(1,1,1),30), (...), ...]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>

        <span class="n">point_coordinates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">point_coordinates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different points cannot have the same label&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">change_reference</span><span class="p">(</span>
                        <span class="n">reciprocal_cell</span><span class="p">,</span>
                        <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span>
                        <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">point_coordinates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different points cannot have the same label&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">change_reference</span><span class="p">(</span>
                        <span class="n">reciprocal_cell</span><span class="p">,</span>
                        <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]]),</span>
                        <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point_coordinates</span><span class="p">[</span><span class="n">piece</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">piece</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="n">num_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Input format not recognized&#39;</span><span class="p">)</span>

    <span class="n">explicit_kpoints</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">point_coordinates</span><span class="p">[</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])]</span>

    <span class="k">for</span> <span class="n">count_piece</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">ini_label</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">end_label</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ini_coord</span> <span class="o">=</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">ini_label</span><span class="p">]</span>
        <span class="n">end_coord</span> <span class="o">=</span> <span class="n">point_coordinates</span><span class="p">[</span><span class="n">end_label</span><span class="p">]</span>

        <span class="n">path_piece</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ini_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="n">num_points</span><span class="p">[</span><span class="n">count_piece</span><span class="p">]),</span>
                         <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ini_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">num_points</span><span class="p">[</span><span class="n">count_piece</span><span class="p">]),</span>
                         <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ini_coord</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">end_coord</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                        <span class="n">num_points</span><span class="p">[</span><span class="n">count_piece</span><span class="p">]),</span>
                         <span class="p">))</span>

        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path_piece</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">explicit_kpoints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">j</span><span class="p">):</span>
                <span class="k">continue</span>  <span class="c1"># avoid duplcates</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">explicit_kpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

            <span class="c1"># add labels for the first and last point</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">explicit_kpoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ini_label</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">path_piece</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">explicit_kpoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end_label</span><span class="p">))</span>

    <span class="c1"># I still have some duplicates in the labels: eliminate them</span>
    <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">point_coordinates</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">bravais_info</span><span class="p">,</span> <span class="n">explicit_kpoints</span><span class="p">,</span> <span class="n">labels</span></div>


<div class="viewcode-block" id="find_bravais_info"><a class="viewcode-back" href="../../../../../../apidoc/aiida.tools.data.array.kpoints.html#aiida.tools.data.array.kpoints.legacy.find_bravais_info">[docs]</a><span class="k">def</span> <span class="nf">find_bravais_info</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="p">,</span> <span class="n">epsilon_length</span><span class="o">=</span><span class="n">_default_epsilon_length</span><span class="p">,</span>
                       <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">_default_epsilon_angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the Bravais lattice of the cell passed in input to the Kpoint class</span>
<span class="sd">    :note: We assume that the cell given by the cell property is the</span>
<span class="sd">    primitive unit cell.</span>

<span class="sd">    .. note:: in 3D, this implementation expects</span>
<span class="sd">       that the structure is already standardized according to the Setyawan</span>
<span class="sd">       paper. If this is not the case, the kpoints and band structure returned will be incorrect. The only case</span>
<span class="sd">       that is dealt correctly by the library is the case when axes are swapped, where the library correctly</span>
<span class="sd">       takes this swapping/rotation into account to assign kpoint labels and coordinates.</span>


<span class="sd">    :param cell: 3x3 array representing the structure cell lattice vectors</span>
<span class="sd">    :param pbc: 3-dimensional array of booleans signifying the periodic boundary</span>
<span class="sd">        conditions along each lattice vector</span>
<span class="sd">        passed in value as cartesian coordinates. Default: False.</span>
<span class="sd">    :param float epsilon_length: threshold on lengths comparison, used</span>
<span class="sd">        to get the bravais lattice info. It has to be used if the</span>
<span class="sd">        user wants to be sure the right symmetries are recognized.</span>
<span class="sd">    :param float epsilon_angle: threshold on angles comparison, used</span>
<span class="sd">        to get the bravais lattice info. It has to be used if the</span>
<span class="sd">        user wants to be sure the right symmetries are recognized.</span>
<span class="sd">    :return: a dictionary, with keys short_name, extended_name, index</span>
<span class="sd">            (index of the Bravais lattice), and sometimes variation (name of</span>
<span class="sd">            the variation of the Bravais lattice) and extra (a dictionary</span>
<span class="sd">            with extra parameters used by the get_kpoints_path method)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="p">)</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">]</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;a3&#39;</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
    <span class="n">cosa</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;cosalpha&#39;</span><span class="p">]</span>
    <span class="n">cosb</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;cosbeta&#39;</span><span class="p">]</span>
    <span class="n">cosc</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;cosgamma&#39;</span><span class="p">]</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;dimension&#39;</span><span class="p">]</span>
    <span class="n">pbc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pbc</span><span class="p">)</span>

    <span class="c1"># values of cosines at various angles</span>
    <span class="n">_90</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">_60</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">_30</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="n">_120</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>

    <span class="c1"># NOTE: in what follows, I&#39;m assuming the textbook order of alfa, beta and gamma</span>

    <span class="c1"># TODO: Maybe additional checks to see if the &quot;correct&quot; primitive</span>
    <span class="c1"># cell is used ? (there are other equivalent primitive</span>
    <span class="c1"># unit cells to the one expected here, typically for body-, c-, and</span>
    <span class="c1"># face-centered lattices)</span>

    <span class="k">def</span> <span class="nf">l_are_equals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># function to compare lengths</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon_length</span>

    <span class="k">def</span> <span class="nf">a_are_equals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># function to compare angles (actually, cosines)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon_angle</span>

    <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># =========================================#</span>
        <span class="c1"># 3D case -&gt; 14 possible Bravais lattices #</span>
        <span class="c1"># =========================================#</span>

        <span class="n">comparison_length</span> <span class="o">=</span> <span class="p">[</span><span class="n">l_are_equals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">l_are_equals</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span>
                             <span class="n">l_are_equals</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span>
        <span class="n">comparison_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">cosb</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">cosc</span><span class="p">),</span>
                             <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">cosa</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">comparison_length</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="c1"># needed for the body centered orthorhombic:</span>
            <span class="n">orci_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span>
            <span class="n">orci_b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span>
            <span class="n">orci_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
            <span class="n">orci_the_a</span><span class="p">,</span> <span class="n">orci_the_b</span><span class="p">,</span> <span class="n">orci_the_c</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">orci_a</span><span class="p">,</span> <span class="n">orci_b</span><span class="p">,</span> <span class="n">orci_c</span><span class="p">])</span>
            <span class="n">bco1</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">orci_the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">orci_the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">orci_the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">bco2</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">orci_the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">orci_the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">orci_the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">bco3</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">orci_the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">orci_the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">orci_the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># ======================#</span>
            <span class="c1"># simple cubic lattice #</span>
            <span class="c1"># ======================#</span>
            <span class="k">if</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_90</span><span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;cub&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;cubic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                                <span class="p">}</span>
            <span class="c1"># =====================#</span>
            <span class="c1"># face centered cubic #</span>
            <span class="c1"># =====================#</span>
            <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_60</span><span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;fcc&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;face centered cubic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                                <span class="p">}</span>
            <span class="c1"># =====================#</span>
            <span class="c1"># body centered cubic #</span>
            <span class="c1"># =====================#</span>
            <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;bcc&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;body centered cubic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                                <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                                <span class="p">}</span>
            <span class="c1"># ==============#</span>
            <span class="c1"># rhombohedral #</span>
            <span class="c1"># ==============#</span>
            <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># logical order is important, this check must come after the cubic cases</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rhl&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rhombohedral&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
                                <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                                <span class="p">}</span>
                <span class="k">if</span> <span class="n">cosa</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rhl1&#39;</span>
                    <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">cosa</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">+</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">cosa</span><span class="p">)</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                             <span class="s1">&#39;nu&#39;</span><span class="p">:</span> <span class="mf">0.75</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                             <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rhl2&#39;</span>
                    <span class="n">eta</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cosa</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">cosa</span><span class="p">))</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                             <span class="s1">&#39;nu&#39;</span><span class="p">:</span> <span class="mf">0.75</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                             <span class="p">}</span>

            <span class="c1"># ==========================#</span>
            <span class="c1"># body centered tetragonal #</span>
            <span class="c1"># ==========================#</span>
            <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># two angles are the same</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;bct&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;body centered tetragonal&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="k">if</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># alfa=beta</span>
                    <span class="n">ref_ang</span> <span class="o">=</span> <span class="n">cosa</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># beta=gamma</span>
                    <span class="n">ref_ang</span> <span class="o">=</span> <span class="n">cosb</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># comparison_angles.index(True)==2: # gamma = alfa</span>
                    <span class="n">ref_ang</span> <span class="o">=</span> <span class="n">cosc</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">ref_ang</span> <span class="o">&gt;=</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Problems on the definition of &#39;</span>
                                     <span class="s1">&#39;body centered tetragonal lattices&#39;</span><span class="p">)</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">ref_ang</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">the_c</span> <span class="o">&lt;</span> <span class="n">the_a</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bct1&#39;</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_c</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bct2&#39;</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="p">((</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                             <span class="p">}</span>

            <span class="c1"># ============================#</span>
            <span class="c1"># body centered orthorhombic #</span>
            <span class="c1"># ============================#</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco1</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">bco1</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco1</span><span class="p">)])</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco2</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">bco2</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco2</span><span class="p">)])</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco3</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">bco3</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco3</span><span class="p">)])</span>
                  <span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;orci&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;body centered orthorhombic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco3</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco2</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco3</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco2</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco3</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco1</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">bco3</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">bco1</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">orci_the_a</span> <span class="o">/</span> <span class="n">orci_the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                         <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">orci_the_b</span> <span class="o">/</span> <span class="n">orci_the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                         <span class="s1">&#39;dlt&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">orci_the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">orci_the_a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">orci_the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                                         <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">orci_the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">orci_the_b</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">orci_the_c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                                         <span class="p">}</span>

            <span class="c1"># if it doesn&#39;t fall in the above, is triclinic</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tri&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;triclinic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="c1"># the check for triclinic variations is at the end of the method</span>



        <span class="k">elif</span> <span class="n">comparison_length</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># ============#</span>
            <span class="c1"># tetragonal #</span>
            <span class="c1"># ============#</span>
            <span class="k">if</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_90</span><span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tet&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tetragonal&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># ====================================#</span>
            <span class="c1"># c-centered orthorombic + hexagonal #</span>
            <span class="c1"># ====================================#</span>
            <span class="c1"># alpha/=beta=gamma=pi/2</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_90</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">_90</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">_90</span><span class="p">)])</span>
                  <span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_120</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">_120</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">_120</span><span class="p">)]):</span>
                    <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;hex&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;hexagonal&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                                    <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;orcc&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;c-centered orthorhombic&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
                                    <span class="p">}</span>
                    <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a1</span>
                        <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="k">elif</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a2</span>
                        <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># comparison_length[2]==True:</span>
                        <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a3</span>
                        <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">the_a1</span> <span class="o">+</span> <span class="n">the_a2</span><span class="p">)</span>
                    <span class="n">the_b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">the_a1</span> <span class="o">-</span> <span class="n">the_a2</span><span class="p">)</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="p">}</span>

                <span class="c1"># TODO : re-check this case, permutations look weird</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># =======================#</span>
            <span class="c1"># c-centered monoclinic #</span>
            <span class="c1"># =======================#</span>
            <span class="k">elif</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;mclc&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;c-centered monoclinic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="c1"># TODO : re-check this case, permutations look weird</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="n">the_ka</span> <span class="o">=</span> <span class="n">cosa</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">c</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">the_ka</span> <span class="o">=</span> <span class="n">cosb</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">a</span>
                <span class="k">if</span> <span class="n">comparison_length</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">the_ka</span> <span class="o">=</span> <span class="n">cosc</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">b</span>

                <span class="n">the_b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">the_a1</span> <span class="o">+</span> <span class="n">the_a2</span><span class="p">)</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">the_a1</span> <span class="o">-</span> <span class="n">the_a2</span><span class="p">)</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">the_a1</span><span class="p">)</span> <span class="o">/</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_ka</span>

                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">the_ka</span><span class="p">,</span> <span class="n">_90</span><span class="p">):</span>  <span class="c1"># order matters: has to be before the check on mclc1</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mclc2&#39;</span>
                    <span class="n">csi</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="n">psi</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">-</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">the_b</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="n">csi</span><span class="p">,</span>
                                             <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">,</span>
                                             <span class="s1">&#39;psi&#39;</span><span class="p">:</span> <span class="n">psi</span><span class="p">,</span>
                                             <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="n">psi</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.75</span> <span class="o">-</span> <span class="n">psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">,</span>
                                             <span class="p">}</span>
                <span class="k">elif</span> <span class="n">the_ka</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mclc1&#39;</span>
                    <span class="n">csi</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="n">psi</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">-</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">the_b</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="n">csi</span><span class="p">,</span>
                                             <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">,</span>
                                             <span class="s1">&#39;psi&#39;</span><span class="p">:</span> <span class="n">psi</span><span class="p">,</span>
                                             <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="n">psi</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.75</span> <span class="o">-</span> <span class="n">psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">,</span>
                                             <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># if the_ka&gt;0.:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span> <span class="o">+</span> <span class="n">the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span>
                    <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.</span><span class="p">):</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mclc4&#39;</span>  <span class="c1"># order matters here too</span>
                        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_b</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span>
                        <span class="n">dlt</span> <span class="o">=</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">csi</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                        <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span>
                        <span class="n">phi</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">mu</span>
                        <span class="n">psi</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">dlt</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="n">mu</span><span class="p">,</span>
                                                 <span class="s1">&#39;dlt&#39;</span><span class="p">:</span> <span class="n">dlt</span><span class="p">,</span>
                                                 <span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="n">csi</span><span class="p">,</span>
                                                 <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                                 <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="n">phi</span><span class="p">,</span>
                                                 <span class="s1">&#39;psi&#39;</span><span class="p">:</span> <span class="n">psi</span><span class="p">,</span>
                                                 <span class="p">}</span>
                    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mclc3&#39;</span>
                        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_b</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span>
                        <span class="n">dlt</span> <span class="o">=</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">csi</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                        <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span>
                        <span class="n">phi</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">mu</span>
                        <span class="n">psi</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">dlt</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="n">mu</span><span class="p">,</span>
                                                 <span class="s1">&#39;dlt&#39;</span><span class="p">:</span> <span class="n">dlt</span><span class="p">,</span>
                                                 <span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="n">csi</span><span class="p">,</span>
                                                 <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                                 <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="n">phi</span><span class="p">,</span>
                                                 <span class="s1">&#39;psi&#39;</span><span class="p">:</span> <span class="n">psi</span><span class="p">,</span>
                                                 <span class="p">}</span>
                    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mclc5&#39;</span>
                        <span class="n">csi</span> <span class="o">=</span> <span class="p">((</span><span class="n">the_b</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mf">4.</span>
                        <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span>
                        <span class="n">mu</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">4.</span> <span class="o">/</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">/</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="n">nu</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">csi</span>
                        <span class="n">omg</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">/</span> <span class="p">(</span>
                        <span class="mf">2.</span> <span class="o">*</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span><span class="p">)</span>
                        <span class="n">dlt</span> <span class="o">=</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span> <span class="o">+</span> <span class="n">omg</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mf">0.25</span>
                        <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span> <span class="o">*</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">the_b</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="n">mu</span><span class="p">,</span>
                                                 <span class="s1">&#39;dlt&#39;</span><span class="p">:</span> <span class="n">dlt</span><span class="p">,</span>
                                                 <span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="n">csi</span><span class="p">,</span>
                                                 <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                                 <span class="s1">&#39;rho&#39;</span><span class="p">:</span> <span class="n">rho</span><span class="p">,</span>
                                                 <span class="p">}</span>

            <span class="c1"># if it doesn&#39;t fall in the above, is triclinic</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tri&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;triclinic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="c1"># the check for triclinic variations is at the end of the method</span>



        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if comparison_length.count(True)==0:</span>

            <span class="n">fco1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">fco2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">fco3</span> <span class="o">=</span> <span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
            <span class="c1"># ==============#</span>
            <span class="c1"># orthorhombic #</span>
            <span class="c1"># ==============#</span>
            <span class="k">if</span> <span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;orc&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;orthorhombic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
                <span class="n">ind_a</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
                <span class="n">ind_c</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1"># ============#</span>
            <span class="c1"># monoclinic #</span>
            <span class="c1"># ============#</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">comparison_angles</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_90</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">_90</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">_90</span><span class="p">)])):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;mcl&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;monoclinic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                                <span class="p">}</span>
                <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
                <span class="c1"># find the angle different from 90</span>
                <span class="c1"># then order (if possible) a&lt;b&lt;c</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">_90</span><span class="p">):</span>
                    <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosa</span>
                    <span class="n">the_a</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                    <span class="n">the_b</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">c</span>
                    <span class="k">if</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">the_a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">_90</span><span class="p">):</span>
                    <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosb</span>
                    <span class="n">the_a</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                    <span class="n">the_b</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">b</span>
                    <span class="k">if</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">the_a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># if not _are_equals(cosc,_90):</span>
                    <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosc</span>
                    <span class="n">the_a</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                    <span class="n">the_b</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                    <span class="n">the_c</span> <span class="o">=</span> <span class="n">a</span>
                    <span class="k">if</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">the_a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_b</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">the_cosa</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="n">eta</span><span class="p">,</span>
                                         <span class="s1">&#39;nu&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">the_c</span> <span class="o">*</span> <span class="n">the_cosa</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">,</span>
                                         <span class="p">}</span>
            <span class="c1"># ============================#</span>
            <span class="c1"># face centered orthorhombic #</span>
            <span class="c1"># ============================#</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">fco1</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">fco1</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">fco1</span><span class="p">)])</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">fco2</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">fco2</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">fco2</span><span class="p">)])</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">([</span><span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">fco3</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosb</span><span class="p">,</span> <span class="n">fco3</span><span class="p">),</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosc</span><span class="p">,</span> <span class="n">fco3</span><span class="p">)])</span>
                  <span class="p">):</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;orcf&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;face centered orthorhombic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                                <span class="p">}</span>

                <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
                <span class="n">ind_a1</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
                <span class="n">ind_a3</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">ind_a1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_a3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a3</span>
                <span class="k">elif</span> <span class="n">ind_a1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_a3</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a2</span>
                <span class="k">elif</span> <span class="n">ind_a1</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_a3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a3</span>
                <span class="k">elif</span> <span class="n">ind_a1</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_a3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a1</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a2</span>
                <span class="k">elif</span> <span class="n">ind_a1</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ind_a3</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a1</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># ind_a1 == 2 and ind_a3 == 0:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">the_a1</span> <span class="o">=</span> <span class="n">a3</span>
                    <span class="n">the_a2</span> <span class="o">=</span> <span class="n">a2</span>
                    <span class="n">the_a3</span> <span class="o">=</span> <span class="n">a1</span>

                <span class="n">the_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="o">-</span> <span class="n">the_a1</span> <span class="o">+</span> <span class="n">the_a2</span> <span class="o">+</span> <span class="n">the_a3</span><span class="p">)</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="o">+</span> <span class="n">the_a1</span> <span class="o">-</span> <span class="n">the_a2</span> <span class="o">+</span> <span class="n">the_a3</span><span class="p">)</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="o">+</span> <span class="n">the_a1</span> <span class="o">+</span> <span class="n">the_a2</span> <span class="o">-</span> <span class="n">the_a3</span><span class="p">)</span>

                <span class="n">fco4</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">the_a</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">the_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">the_c</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="c1"># orcf3</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">fco4</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;orcf3&#39;</span>  <span class="c1"># order matters</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="p">}</span>
                <span class="c1"># orcf1</span>
                <span class="k">elif</span> <span class="n">fco4</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;orcf1&#39;</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="p">}</span>
                <span class="c1"># orcf2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;orcf2&#39;</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">the_a</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="s1">&#39;dlt&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_b</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_b</span> <span class="o">/</span> <span class="n">the_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">the_c</span> <span class="o">/</span> <span class="n">the_b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">the_c</span> <span class="o">/</span> <span class="n">the_a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">,</span>
                                             <span class="p">}</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tri&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;triclinic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                                <span class="p">}</span>
        <span class="c1"># ===========#</span>
        <span class="c1"># triclinic #</span>
        <span class="c1"># ===========#</span>
        <span class="c1"># still miss the variations of triclinic</span>
        <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;short_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
            <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
            <span class="n">ind_a</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
            <span class="n">ind_c</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ind_a</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ind_c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">the_a</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">the_b</span> <span class="o">=</span> <span class="n">a</span>
                <span class="n">the_c</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">the_cosa</span> <span class="o">=</span> <span class="n">cosc</span>
                <span class="n">the_cosb</span> <span class="o">=</span> <span class="n">cosa</span>
                <span class="n">the_cosc</span> <span class="o">=</span> <span class="n">cosb</span>
                <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">the_cosa</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">the_cosb</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">the_cosc</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tri2a&#39;</span>
                <span class="k">elif</span> <span class="n">the_cosc</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tri1a&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Structure erroneously fell into the triclinic (a) case&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">the_cosa</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">the_cosb</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">the_cosc</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tri2b&#39;</span>
                <span class="k">elif</span> <span class="n">the_cosc</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tri1b&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Structure erroneously fell into the triclinic (b) case&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Structure erroneously fell into the triclinic case&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># ========================================#</span>
        <span class="c1"># 2D case -&gt; 5 possible Bravais lattices #</span>
        <span class="c1"># ========================================#</span>

        <span class="c1"># find the two in-plane lattice vectors</span>
        <span class="n">out_of_plane_index</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># the non-periodic dimension</span>
        <span class="n">in_plane_indexes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">out_of_plane_index</span><span class="p">]))</span>
        <span class="c1"># in_plane_indexes are the indexes of the two dimensions (e.g. [0,1])</span>

        <span class="c1"># build a length-2 list with the 2D cell lattice vectors</span>
        <span class="n">list_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">]</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">eval</span><span class="p">(</span><span class="n">list_vectors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">in_plane_indexes</span><span class="p">]</span>
        <span class="c1"># build a length-2 list with the norms of the 2D cell lattice vectors</span>
        <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">]</span>
        <span class="c1"># cosine of the angle between the two primitive vectors</span>
        <span class="n">list_angles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cosa&#39;</span><span class="p">,</span> <span class="s1">&#39;cosb&#39;</span><span class="p">,</span> <span class="s1">&#39;cosc&#39;</span><span class="p">]</span>
        <span class="n">cosphi</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">list_angles</span><span class="p">[</span><span class="n">out_of_plane_index</span><span class="p">])</span>

        <span class="n">comparison_length</span> <span class="o">=</span> <span class="n">l_are_equals</span><span class="p">(</span><span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">comparison_angle_90</span> <span class="o">=</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosphi</span><span class="p">,</span> <span class="n">_90</span><span class="p">)</span>

        <span class="c1"># ================#</span>
        <span class="c1"># square lattice #</span>
        <span class="c1"># ================#</span>
        <span class="k">if</span> <span class="n">comparison_angle_90</span> <span class="ow">and</span> <span class="n">comparison_length</span><span class="p">:</span>
            <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;sq&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="p">}</span>

        <span class="c1"># =========================#</span>
        <span class="c1"># (primitive) rectangular #</span>
        <span class="c1"># =========================#</span>
        <span class="k">elif</span> <span class="n">comparison_angle_90</span><span class="p">:</span>
            <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rec&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rectangular&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                            <span class="p">}</span>
            <span class="c1"># set the order such that first_vector &lt; second_vector in norm</span>
            <span class="k">if</span> <span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lens</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">in_plane_indexes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="c1"># ===========#</span>
        <span class="c1"># hexagonal #</span>
        <span class="c1"># ===========#</span>
        <span class="c1"># this has to be put before the centered-rectangular case</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">l_are_equals</span><span class="p">(</span><span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">a_are_equals</span><span class="p">(</span><span class="n">cosphi</span><span class="p">,</span> <span class="n">_120</span><span class="p">)):</span>
            <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;hex&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;hexagonal&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                            <span class="p">}</span>

        <span class="c1"># ======================#</span>
        <span class="c1"># centered rectangular #</span>
        <span class="c1"># ======================#</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">comparison_length</span> <span class="ow">and</span>
                  <span class="n">l_are_equals</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                         <span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mf">0.</span><span class="p">)):</span>
            <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;recc&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;centered rectangular&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                            <span class="p">}</span>

        <span class="c1"># =========#</span>
        <span class="c1"># oblique #</span>
        <span class="c1"># =========#</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;obl&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;oblique&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                            <span class="p">}</span>
            <span class="c1"># set the order such that first_vector &lt; second_vector in norm</span>
            <span class="k">if</span> <span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lens</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">in_plane_indexes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="c1"># the permutation is set such that p[2]=out_of_plane_index (third</span>
        <span class="c1"># new axis is always the non-periodic out-of-plane axis)</span>
        <span class="c1"># TODO: check that this (and the special points permutation of</span>
        <span class="c1"># coordinates) works also when the out-of-plane axis is not aligned</span>
        <span class="c1"># with one of the cartesian axis (I suspect that it doesn&#39;t...)</span>
        <span class="n">permutation</span> <span class="o">=</span> <span class="n">in_plane_indexes</span> <span class="o">+</span> <span class="p">[</span><span class="n">out_of_plane_index</span><span class="p">]</span>
        <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">permutation</span>

    <span class="k">elif</span> <span class="n">dimension</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># ====================================================#</span>
        <span class="c1"># 0D &amp; 1D cases -&gt; only one possible Bravais lattice #</span>
        <span class="c1"># ====================================================#</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># TODO: check that this (and the special points permutation of</span>
            <span class="c1"># coordinates) works also when the 1D axis is not aligned</span>
            <span class="c1"># with one of the cartesian axis (I suspect that it doesn&#39;t...)</span>
            <span class="n">in_line_index</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># the only periodic dimension</span>
            <span class="c1"># the permutation is set such that p[0]=in_line_index (the 2 last</span>
            <span class="c1"># axes are always the non-periodic ones)</span>
            <span class="n">permutation</span> <span class="o">=</span> <span class="p">[</span><span class="n">in_line_index</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">in_line_index</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="n">bravais_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;short_name&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">D&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dimension</span><span class="p">),</span>
            <span class="s1">&#39;extended_name&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">D&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dimension</span><span class="p">),</span>
            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="n">permutation</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">bravais_info</span></div>



<div class="viewcode-block" id="get_kpoints_path"><a class="viewcode-back" href="../../../../../../apidoc/aiida.tools.data.array.kpoints.html#aiida.tools.data.array.kpoints.legacy.get_kpoints_path">[docs]</a><span class="k">def</span> <span class="nf">get_kpoints_path</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">epsilon_length</span><span class="o">=</span><span class="n">_default_epsilon_length</span><span class="p">,</span>
                       <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">_default_epsilon_angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the special point and path of a given structure.</span>

<span class="sd">    .. note:: in 3D, this implementation expects</span>
<span class="sd">       that the structure is already standardized according to the Setyawan</span>
<span class="sd">       paper. If this is not the case, the kpoints and band structure returned will be incorrect. The only case</span>
<span class="sd">       that is dealt correctly by the library is the case when axes are swapped, where the library correctly</span>
<span class="sd">       takes this swapping/rotation into account to assign kpoint labels and coordinates.</span>

<span class="sd">    - In 2D, coordinates are based on the paper:</span>
<span class="sd">      R. Ramirez and M. C. Bohm,  Int. J. Quant. Chem., XXX, pp. 391-411 (1986)</span>

<span class="sd">    - In 3D, coordinates are based on the paper:</span>
<span class="sd">      W. Setyawan, S. Curtarolo, Comp. Mat. Sci. 49, 299 (2010)</span>

<span class="sd">    :param cell: 3x3 array representing the structure cell lattice vectors</span>
<span class="sd">    :param pbc: 3-dimensional array of booleans signifying the periodic boundary</span>
<span class="sd">        conditions along each lattice vector</span>
<span class="sd">    :param cartesian: If true, returns points in cartesian coordinates.</span>
<span class="sd">        Crystal coordinates otherwise. Default=False</span>
<span class="sd">    :param epsilon_length: threshold on lengths comparison, used</span>
<span class="sd">        to get the bravais lattice info</span>
<span class="sd">    :param epsilon_angle: threshold on angles comparison, used</span>
<span class="sd">        to get the bravais lattice info</span>
<span class="sd">    :return special_points,path: special_points: a dictionary of</span>
<span class="sd">        point_name:point_coords key,values.</span>

<span class="sd">        path: the suggested path which goes through all high symmetry</span>
<span class="sd">        lines. A list of lists for all path segments.</span>
<span class="sd">        e.g. ``[(&#39;G&#39;,&#39;X&#39;),(&#39;X&#39;,&#39;M&#39;),...]``</span>
<span class="sd">        It&#39;s not necessarily a continuous line.</span>
<span class="sd">    :note: We assume that the cell given by the cell property is the</span>
<span class="sd">        primitive unit cell</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># recognize which bravais lattice we are dealing with</span>
    <span class="n">bravais_info</span> <span class="o">=</span> <span class="n">find_bravais_info</span><span class="p">(</span>
        <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="n">pbc</span><span class="p">,</span>
        <span class="n">epsilon_length</span><span class="o">=</span><span class="n">epsilon_length</span><span class="p">,</span>
        <span class="n">epsilon_angle</span><span class="o">=</span><span class="n">epsilon_angle</span>
    <span class="p">)</span>

    <span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="p">)</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;dimension&#39;</span><span class="p">]</span>
    <span class="n">reciprocal_cell</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;reciprocal_cell&#39;</span><span class="p">]</span>

    <span class="c1"># pick the information about the special k-points.</span>
    <span class="c1"># it depends on the dimensionality and the Bravais lattice number.</span>
    <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># 3D case: 14 Bravais lattices</span>
        <span class="c1"># simple cubic</span>
        <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># face centered cubic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.</span> <span class="o">/</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">3.</span> <span class="o">/</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
                              <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.</span> <span class="o">/</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">5.</span> <span class="o">/</span> <span class="mf">8.</span><span class="p">],</span>
                              <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># body centered cubic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
                              <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># Tetragonal</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># body centered tetragonal</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bct1&#39;</span><span class="p">:</span>
                <span class="c1"># Body centered tetragonal bct1</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;Z1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;Z1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z1&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># bct2</span>
                <span class="c1"># Body centered tetragonal bct2</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
                    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;S1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">],</span>
                    <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

        <span class="c1"># orthorhombic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># face centered orthorhombic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;orcf1&#39;</span><span class="p">:</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">],</span>
                                  <span class="s1">&#39;A1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;orcf2&#39;</span><span class="p">:</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">dlt</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;dlt&#39;</span><span class="p">]</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">dlt</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;D1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">dlt</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">],</span>
                                  <span class="s1">&#39;A1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

        <span class="c1"># Body centered orthorhombic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
            <span class="n">dlt</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;dlt&#39;</span><span class="p">]</span>
            <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">dlt</span><span class="p">],</span>
                              <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">dlt</span><span class="p">],</span>
                              <span class="s1">&#39;L2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">dlt</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">dlt</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">],</span>
                              <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                              <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">],</span>
                              <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># C-centered orthorhombic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;A1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># Hexagonal</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="c1"># rhombohedral</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;rhl1&#39;</span><span class="p">:</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">],</span>
                                  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">],</span>
                                  <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;P2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eta</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">],</span>
                                  <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nu</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">nu</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Rhombohedral rhl2</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="o">-</span><span class="n">nu</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">],</span>
                                  <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nu</span><span class="p">,</span> <span class="n">nu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">nu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">],</span>
                                  <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

        <span class="c1"># monoclinic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
            <span class="n">nu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;D1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;M1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">,</span> <span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;M2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="o">-</span><span class="n">nu</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mclc1&#39;</span><span class="p">:</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">psi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;psi&#39;</span><span class="p">]</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="n">phi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">,</span> <span class="n">psi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">psi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">psi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="n">psi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mclc2&#39;</span><span class="p">:</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">psi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;psi&#39;</span><span class="p">]</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;F3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="n">phi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">,</span> <span class="n">psi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">psi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">psi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="n">psi</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mclc3&#39;</span><span class="p">:</span>
                <span class="n">mu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span>
                <span class="n">dlt</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;dlt&#39;</span><span class="p">]</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
                <span class="n">psi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;psi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">],</span>
                    <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">psi</span><span class="p">],</span>
                    <span class="s1">&#39;F2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">],</span>
                    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mclc4&#39;</span><span class="p">:</span>
                <span class="n">mu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span>
                <span class="n">dlt</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;dlt&#39;</span><span class="p">]</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
                <span class="n">psi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;psi&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">],</span>
                                  <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">psi</span><span class="p">],</span>
                                  <span class="s1">&#39;F2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">phi</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">psi</span><span class="p">],</span>
                                  <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                                  <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;Y2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;Y3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">csi</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;csi&#39;</span><span class="p">]</span>
                <span class="n">mu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span>
                <span class="n">omg</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;omg&#39;</span><span class="p">]</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
                <span class="n">dlt</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;dlt&#39;</span><span class="p">]</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;extra&#39;</span><span class="p">][</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">omg</span><span class="p">],</span>
                    <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">omg</span><span class="p">],</span>
                    <span class="s1">&#39;F2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nu</span><span class="p">,</span> <span class="n">nu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">omg</span><span class="p">],</span>
                    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">csi</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="o">-</span><span class="n">csi</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">eta</span><span class="p">],</span>
                    <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">rho</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">rho</span><span class="p">,</span> <span class="n">rho</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;N1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Y3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">dlt</span><span class="p">],</span>
                    <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

        <span class="c1"># triclinic</span>
        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tri1a&#39;</span> <span class="ow">or</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;variation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tri2a&#39;</span><span class="p">:</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                                  <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                  <span class="p">}</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                        <span class="p">]</span>

    <span class="k">elif</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># 2D case: 5 Bravais lattices</span>
        <span class="k">if</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># square</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># (primitive) rectangular</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># centered rectangular (rhombic)</span>
            <span class="c1"># TODO: this looks quite different from the in-plane part of the</span>
            <span class="c1"># 3D C-centered orthorhombic lattice, which is strange...</span>

            <span class="c1"># NOTE: special points below are in (b1, b2) fractional</span>
            <span class="c1"># coordinates (primitive reciprocal cell) as for the rest.</span>
            <span class="c1"># Ramirez &amp; Bohn gave them initially in (s1=b1+b2, s2=-b1+b2)</span>
            <span class="c1"># coordinates, i.e. using the conventional reciprocal cell.</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>  <span class="c1"># typo in p. 404 of Ramirez &amp; Bohm (should be Y=(0,1/4))</span>
                              <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="c1"># hexagonal</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="k">elif</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1"># oblique</span>
            <span class="c1"># NOTE: only end-points are high-symmetry points (not the path</span>
            <span class="c1"># in-between)</span>
            <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                              <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                    <span class="p">]</span>

    <span class="k">elif</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># 1D case: 1 Bravais lattice</span>
        <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                          <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                          <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span>
                <span class="p">]</span>

    <span class="k">elif</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># 0D case: 1 Bravais lattice, only Gamma point, no path</span>
        <span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                          <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>
                <span class="p">]</span>

    <span class="n">permutation</span> <span class="o">=</span> <span class="n">bravais_info</span><span class="p">[</span><span class="s1">&#39;permutation&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">permute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">permutation</span><span class="p">):</span>
        <span class="c1"># return new_x such that new_x[i]=x[permutation[i]]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutation</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">invpermute</span><span class="p">(</span><span class="n">permutation</span><span class="p">):</span>
        <span class="c1"># return the inverse of permutation</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">permutation</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

    <span class="n">the_special_points</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">special_points</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># NOTE: this originally returned the inverse of the permutation, but was later changed to permutation</span>
        <span class="n">the_special_points</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">permute</span><span class="p">(</span><span class="n">special_points</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">permutation</span><span class="p">)</span>

    <span class="c1"># output crystal or cartesian</span>
    <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
        <span class="n">the_abs_special_points</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">the_special_points</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">the_abs_special_points</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">change_reference</span><span class="p">(</span>
                <span class="n">reciprocal_cell</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">the_special_points</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">to_cartesian</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">the_abs_special_points</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">bravais_info</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">the_special_points</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">bravais_info</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>