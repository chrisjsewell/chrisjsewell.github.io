

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.tools.importexport.dbimport &mdash; AiiDA 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/togglebutton.js"></script>
        <script src="../../../../_static/contentui.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/about.html">What is AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../howto/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../plugins/placeholder.html">Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../development/placeholder.html">Placeholder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../aiida.html">aiida</a> &raquo;</li>
        
      <li>aiida.tools.importexport.dbimport</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida.tools.importexport.dbimport</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###########################################################################</span>
<span class="c1"># Copyright (c), The AiiDA team. All rights reserved.                     #</span>
<span class="c1"># This file is part of the AiiDA code.                                    #</span>
<span class="c1">#                                                                         #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/aiidateam/aiida-core #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file        #</span>
<span class="c1"># For further information please visit http://www.aiida.net               #</span>
<span class="c1">###########################################################################</span>
<span class="sd">&quot;&quot;&quot;Provides import functionalities.&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;import_data&#39;</span><span class="p">,)</span>


<div class="viewcode-block" id="import_data"><a class="viewcode-back" href="../../../../apidoc/aiida.tools.importexport.dbimport.html#aiida.tools.importexport.import_data">[docs]</a><span class="k">def</span> <span class="nf">import_data</span><span class="p">(</span><span class="n">in_path</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import exported AiiDA archive to the AiiDA database and repository.</span>

<span class="sd">    Proxy function for the backend-specific import functions.</span>
<span class="sd">    If ``in_path`` is a folder, calls extract_tree; otherwise, tries to detect the compression format</span>
<span class="sd">    (zip, tar.gz, tar.bz2, ...) and calls the correct function.</span>

<span class="sd">    :param in_path: the path to a file or folder that can be imported in AiiDA.</span>
<span class="sd">    :type in_path: str</span>

<span class="sd">    :param group: Group wherein all imported Nodes will be placed.</span>
<span class="sd">    :type group: :py:class:`~aiida.orm.groups.Group`</span>

<span class="sd">    :param silent: suppress prints.</span>
<span class="sd">    :type silent: bool</span>

<span class="sd">    :param extras_mode_existing: 3 letter code that will identify what to do with the extras import.</span>
<span class="sd">        The first letter acts on extras that are present in the original node and not present in the imported node.</span>
<span class="sd">        Can be either:</span>
<span class="sd">        &#39;k&#39; (keep it) or</span>
<span class="sd">        &#39;n&#39; (do not keep it).</span>
<span class="sd">        The second letter acts on the imported extras that are not present in the original node.</span>
<span class="sd">        Can be either:</span>
<span class="sd">        &#39;c&#39; (create it) or</span>
<span class="sd">        &#39;n&#39; (do not create it).</span>
<span class="sd">        The third letter defines what to do in case of a name collision.</span>
<span class="sd">        Can be either:</span>
<span class="sd">        &#39;l&#39; (leave the old value),</span>
<span class="sd">        &#39;u&#39; (update with a new value),</span>
<span class="sd">        &#39;d&#39; (delete the extra), or</span>
<span class="sd">        &#39;a&#39; (ask what to do if the content is different).</span>
<span class="sd">    :type extras_mode_existing: str</span>

<span class="sd">    :param extras_mode_new: &#39;import&#39; to import extras of new nodes or &#39;none&#39; to ignore them</span>
<span class="sd">    :type extras_mode_new: str</span>

<span class="sd">    :param comment_mode: Comment import modes (when same UUIDs are found).</span>
<span class="sd">        Can be either:</span>
<span class="sd">        &#39;newest&#39; (will keep the Comment with the most recent modification time (mtime)) or</span>
<span class="sd">        &#39;overwrite&#39; (will overwrite existing Comments with the ones from the import file).</span>
<span class="sd">    :type comment_mode: str</span>

<span class="sd">    :return: New and existing Nodes and Links.</span>
<span class="sd">    :rtype: dict</span>

<span class="sd">    :raises `~aiida.tools.importexport.common.exceptions.ArchiveImportError`: if there are any internal errors when</span>
<span class="sd">        importing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">aiida.manage</span> <span class="kn">import</span> <span class="n">configuration</span>
    <span class="kn">from</span> <span class="nn">aiida.backends</span> <span class="kn">import</span> <span class="n">BACKEND_DJANGO</span><span class="p">,</span> <span class="n">BACKEND_SQLA</span>
    <span class="kn">from</span> <span class="nn">aiida.tools.importexport.common.exceptions</span> <span class="kn">import</span> <span class="n">ArchiveImportError</span>

    <span class="k">if</span> <span class="n">configuration</span><span class="o">.</span><span class="n">PROFILE</span><span class="o">.</span><span class="n">database_backend</span> <span class="o">==</span> <span class="n">BACKEND_SQLA</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">aiida.tools.importexport.dbimport.backends.sqla</span> <span class="kn">import</span> <span class="n">import_data_sqla</span>
        <span class="k">return</span> <span class="n">import_data_sqla</span><span class="p">(</span><span class="n">in_path</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="n">silent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">configuration</span><span class="o">.</span><span class="n">PROFILE</span><span class="o">.</span><span class="n">database_backend</span> <span class="o">==</span> <span class="n">BACKEND_DJANGO</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">aiida.tools.importexport.dbimport.backends.django</span> <span class="kn">import</span> <span class="n">import_data_dj</span>
        <span class="k">return</span> <span class="n">import_data_dj</span><span class="p">(</span><span class="n">in_path</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="n">silent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># else</span>
    <span class="k">raise</span> <span class="n">ArchiveImportError</span><span class="p">(</span><span class="s1">&#39;Unknown backend: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">configuration</span><span class="o">.</span><span class="n">PROFILE</span><span class="o">.</span><span class="n">database_backend</span><span class="p">))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>